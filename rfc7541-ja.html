<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01//EN">
<html lang="en"><head profile="http://dublincore.org/documents/2008/08/04/dc-html/"><meta http-equiv="Content-Type" content="text/html; charset=utf-8"><title>HPACK - HTTP/2 のためのヘッダ圧縮</title><script>
function getMeta(rfcno, container) {

  var xhr = new XMLHttpRequest();
  xhr.open("GET", "http://tools.ietf.org/draft/rfc" + rfcno + "/state.xml", true);
  xhr.onload = function (e) {
    if (xhr.readyState === 4) {
      if (xhr.status === 200) {
        var doc = xhr.responseXML;
        var info = getChildByName(doc.documentElement, "info");
  
        var cont = document.getElementById(container);
        // empty the container
        while (cont.firstChild) {
          cont.removeChild(myNode.firstChild);
        }      
  
        var c = getChildByName(info, "stdstatus");
        if (c !== null) {
          var bld = newElementWithText("b", c.textContent);
          cont.appendChild(bld);
        }
  
        c = getChildByName(info, "updatedby");
        if (c !== null) {
          cont.appendChild(newElement("br"));
          cont.appendChild(newText("Updated by: "));
          appendRfcLinks(cont, c.textContent);
        }
  
        c = getChildByName(info, "obsoletedby");
        if (c !== null) {
          cont.appendChild(newElement("br"));
          cont.appendChild(newText("Obsoleted by: "));
          appendRfcLinks(cont, c.textContent);
        }
        
        c = getChildByName(info, "errata");
        if (c !== null) {
          cont.appendChild(newElement("br"));
          var link = newElementWithText("a", "errata");
          link.setAttribute("href", "http://www.rfc-editor.org/errata_search.php?rfc=" + rfcno);
          var errata = newElementWithText("i", "This document has ");
          errata.appendChild(link);
          errata.appendChild(newText("."));
          cont.appendChild(errata);
        }

        cont.style.display = "block";
      } else {
        console.error(xhr.statusText);
      }
    }
  };
  xhr.onerror = function (e) {
    console.error(xhr.status + " " + xhr.statusText);
  };
  xhr.send(null);
}

// DOM helpers
function newElement(name) {
  return document.createElement(name);
}
function newElementWithText(name, txt) {
  var e = document.createElement(name);
  e.appendChild(newText(txt));
  return e;
}
function newText(text) {
  return document.createTextNode(text);
}

function getChildByName(parent, name) {
  if (parent === null) {
    return null;
  }
  else {
    for (var c = parent.firstChild; c !== null; c = c.nextSibling) {
      if (name == c.nodeName) {
        return c;
      }
    }
    return null;
  }
}

function appendRfcLinks(parent, text) {
  var updates = text.split(",");
  for (var i = 0; i < updates.length; i++) {
    var rfc = updates[i].trim();
    if (rfc.substring(0, 3) == "rfc") {
      var link = newElement("a");
      link.setAttribute("href", "http://tools.ietf.org/html/" + rfc);
      link.appendChild(newText(rfc.substring(3)));
      parent.appendChild(link);
    } else {
      parent.appendChild(newText(rfc));
    }
    if (i != updates.length - 1) {
      parent.appendChild(newText(", "));
    }
  }
}
</script><style type="text/css" title="Xml2Rfc (sans serif)">
a {
  text-decoration: none;
}
a.smpl {
  color: black;
}
a:hover {
  text-decoration: underline;
}
a:active {
  text-decoration: underline;
}
address {
  margin-top: 1em;
  margin-left: 2em;
  font-style: normal;
}
body {
  color: black;
  font-family: cambria, georgia, serif;
  font-size: 12pt;
  margin: 2em auto;
  max-width: 1000px;
}
samp, tt, code, pre {
  font-family: consolas, monaco, monospace;
}
cite {
  font-style: normal;
}
dl {
  margin-left: 2em;
}
ul.empty {
  list-style-type: none;
}
ul.empty li {
  margin-top: .5em;
}
dl p {
  margin-left: 0em;
}
dt {
  margin-top: .5em;
}
h1 {
  font-size: 130%;
  line-height: 21pt;
  page-break-after: avoid;
}
h1.np {
  page-break-before: always;
}
h2 {
  font-size: 120%;
  line-height: 15pt;
  page-break-after: avoid;
}
h3 {
  font-size: 110%;
  page-break-after: avoid;
}
h4, h5, h6 {
  page-break-after: avoid;
}
h1 a, h2 a, h3 a, h4 a, h5 a, h6 a {
  color: black;
}
img {
  margin-left: 3em;
}
li {
  margin-left: 2em;
}
ol {
  margin-left: 2em;
}
ol.la {
  list-style-type: lower-alpha;
}
ol.ua {
  list-style-type: upper-alpha;
}
ol p {
  margin-left: 0em;
}
p {
  margin-left: 2em;
}
pre {
  font-size: 11pt;
  margin-left: 3em;
  background-color: lightyellow;
  padding: .25em;
  page-break-inside: avoid;
}
pre.text2 {
  border-style: dotted;
  border-width: 1px;
  background-color: #f0f0f0;
}
pre.inline {
  background-color: white;
  padding: 0em;
  page-break-inside: auto;
}
pre.text {
  border-style: dotted;
  border-width: 1px;
  background-color: #f8f8f8;
}
pre.drawing {
  border-style: solid;
  border-width: 1px;
  background-color: #f8f8f8;
  padding: 2em;
}
table {
  margin-left: 2em;
}
table.tt {
  vertical-align: top;
  border-color: gray;
}
table.tt th {
  border-color: gray;
}
table.tt td {
  border-color: gray;
}
table.all {
  border-style: solid;
  border-width: 2px;
}
table.full {
  border-style: solid;
  border-width: 2px;
}
table.tt td {
  vertical-align: top;
}
table.all td {
  border-style: solid;
  border-width: 1px;
}
table.full td {
  border-style: none solid;
  border-width: 1px;
}
table.tt th {
  vertical-align: top;
}
table.all th {
  border-style: solid;
  border-width: 1px;
}
table.full th {
  border-style: solid;
  border-width: 1px 1px 2px 1px;
}
table.headers th {
  border-style: none none solid none;
  border-width: 2px;
}
table.left {
  margin-right: auto;
}
table.right {
  margin-left: auto;
}
table.center {
  margin-left: auto;
  margin-right: auto;
}
caption {
  caption-side: bottom;
  font-weight: bold;
  font-size: 10pt;
  margin-top: .5em;
}

table.header {
  border-spacing: 1px;
  width: 95%;
  font-size: 11pt;
  color: white;
}
td.top {
  vertical-align: top;
}
td.topnowrap {
  vertical-align: top;
  white-space: nowrap;
}
table.header td {
  background-color: gray;
  width: 50%;
}
td.reference {
  vertical-align: top;
  white-space: nowrap;
  padding-right: 1em;
}
thead {
  display:table-header-group;
}
ul.toc, ul.toc ul {
  list-style: none;
  margin-left: 1.5em;
  padding-left: 0em;
}
ul.toc li {
  line-height: 150%;
  font-weight: bold;
  margin-left: 0em;
}
ul.toc li li {
  line-height: normal;
  font-weight: normal;
  font-size: 11pt;
  margin-left: 0em;
}
li.excluded {
  font-size: 0pt;
}
ul p {
  margin-left: 0em;
}
.title, .filename, h1, h2, h3, h4 {
  font-family: candara, calibri, segoe, optima, arial, sans-serif;
}

.comment {
  background-color: yellow;
}
.center {
  text-align: center;
}
.error {
  color: red;
  font-style: italic;
  font-weight: bold;
}
.figure {
  font-weight: bold;
  text-align: center;
  font-size: 10pt;
}
.filename {
  color: #333333;
  font-size: 75%;
  font-weight: bold;
  line-height: 21pt;
  text-align: center;
}
.fn {
  font-weight: bold;
}
.left {
  text-align: left;
}
.right {
  text-align: right;
}
.title {
  color: green;
  font-size: 150%;
  line-height: 18pt;
  font-weight: bold;
  text-align: center;
  margin-top: 36pt;
}
.warning {
  font-size: 130%;
  background-color: yellow;
}

@media screen {
  pre.text, pre.text2 {
    width: 69em;
  }
}

@media print {
  .noprint {
    display: none;
  }

  a {
    color: black;
    text-decoration: none;
  }

  table.header {
    width: 90%;
  }

  td.header {
    width: 50%;
    color: black;
    background-color: white;
    vertical-align: top;
    font-size: 110%;
  }

  ul.toc a:last-child::after {
    content: leader('.') target-counter(attr(href), page);
  }

  ul.ind li li a {
    content: target-counter(attr(href), page);
  }

  pre {
    font-size: 10pt;
  }

  .print2col {
    column-count: 2;
    -moz-column-count: 2;
    column-fill: auto;
  }
}

@page {
  @top-left {
       content: "RFC 7541";
  }
  @top-right {
       content: "May 2015";
  }
  @top-center {
       content: "HPACK";
  }
  @bottom-left {
       content: "Peon & Ruellan";
  }
  @bottom-center {
       content: "Standards Track";
  }
  @bottom-right {
       content: "[Page " counter(page) "]";
  }
}

@page:first {
    @top-left {
      content: normal;
    }
    @top-right {
      content: normal;
    }
    @top-center {
      content: normal;
    }
}
</style><link rel="Contents" href="#rfc.toc"><link rel="Author" href="#rfc.authors"><link rel="Copyright" href="#rfc.copyrightnotice"><link rel="Chapter" title="1 はじめに" href="#rfc.section.1"><link rel="Chapter" title="2 圧縮処理の概要" href="#rfc.section.2"><link rel="Chapter" title="3 ヘッダブロックのデコード処理" href="#rfc.section.3"><link rel="Chapter" title="4 動的テーブルの管理" href="#rfc.section.4"><link rel="Chapter" title="5 プリミティブ型表現" href="#rfc.section.5"><link rel="Chapter" title="6 バイナリフォーマット" href="#rfc.section.6"><link rel="Chapter" title="7 セキュリティへの配慮" href="#rfc.section.7"><link rel="Chapter" title="8 IANA への配慮" href="#rfc.section.8"><link rel="Chapter" title="9 謝辞" href="#rfc.section.9"><link rel="Chapter" href="#rfc.section.10" title="10 参考文献"><link rel="Appendix" title="A 静的テーブル定義" href="#rfc.section.A"><link rel="Appendix" title="B ハフマン符号" href="#rfc.section.B"><link rel="Appendix" title="C 例" href="#rfc.section.C"><link rel="Alternate" title="Authorative ASCII Version" href="http://www.ietf.org/rfc/rfc7541.txt"><link rel="Help" title="RFC-Editor's Status Page" href="http://www.rfc-editor.org/info/rfc7541"><link rel="Help" title="Additional Information on tools.ietf.org" href="http://tools.ietf.org/html/rfc7541"><meta name="generator" content="http://greenbytes.de/tech/webdav/rfc2629.xslt, Revision 1.690, 2014/11/12 21:37:29, XSLT vendor: libxslt http://xmlsoft.org/XSLT/"><meta name="keywords" content="HTTP, Header"><link rel="schema.dct" href="http://purl.org/dc/terms/"><meta name="dct.creator" content="Peon, R."><meta name="dct.creator" content="Ruellan, H."><meta name="dct.identifier" content="urn:ietf:rfc:7541"><meta name="dct.issued" scheme="ISO8601" content="2015-05"><meta name="dct.abstract" content="この仕様書は HTTP/2 で使われる HTTP ヘッダフィールドを 効率的に表現する圧縮フォーマット HPACK を定義 します。"><meta name="dct.isPartOf" content="urn:issn:2070-1721"><meta name="description" content="この仕様書は HTTP/2 で使われる HTTP ヘッダフィールドを 効率的に表現する圧縮フォーマット HPACK を定義 します。"></head><body onload='getMeta(7541,"rfc.meta");'><table class="header" id="rfc.headerblock"><tbody><tr><td class="left">Internet Engineering Task Force (IETF)</td><td class="right">R. Peon</td></tr><tr><td class="left">Request for Comments: 7541</td><td class="right">Google, Inc</td></tr><tr><td class="left">Category: Standards Track</td><td class="right">H. Ruellan</td></tr><tr><td class="left">ISSN: 2070-1721</td><td class="right">Canon CRF</td></tr><tr><td class="left"></td><td class="right">May 2015</td></tr></tbody></table><p class="title" id="rfc.title">HPACK - HTTP/2 のためのヘッダ圧縮</p><h1 id="rfc.abstract"><a href="#rfc.abstract">概要</a></h1><p>この仕様書は HTTP/2 で使われる HTTP ヘッダフィールドを 効率的に表現する圧縮フォーマット HPACK を定義 します。</p><div id="rfc.meta" style="float: right; border: 1px solid black; margin: 2em; padding: 1em; display: none;"></div><div id="rfc.status"><h1><a href="#rfc.status">Status of This Memo</a></h1><p>This is an Internet Standards Track document.</p><p>This document is a product of the Internet Engineering Task Force (IETF). It represents the consensus of the IETF community. It has received public review and has been approved for publication by the Internet Engineering Steering Group (IESG). Further information on Internet Standards is available in Section 2 of RFC 5741.</p><p>Information about the current status of this document, any errata, and how to provide feedback on it may be obtained at <a href="http://www.rfc-editor.org/info/rfc7541">http://www.rfc-editor.org/info/rfc7541</a>.</p></div><div id="rfc.copyrightnotice"><h1><a href="#rfc.copyrightnotice">Copyright Notice</a></h1><p>Copyright © 2015 IETF Trust and the persons identified as the document authors. All rights reserved.</p><p>This document is subject to BCP 78 and the IETF Trust's Legal Provisions Relating to IETF Documents (<a href="http://trustee.ietf.org/license-info">http://trustee.ietf.org/license-info</a>) in effect on the date of publication of this document. Please review these documents carefully, as they describe your rights and restrictions with respect to this document. Code Components extracted from this document must include Simplified BSD License text as described in Section 4.e of the Trust Legal Provisions and are provided without warranty as described in the Simplified BSD License.</p></div><hr class="noprint"><div id="rfc.toc"><h1 class="np"><a href="#rfc.toc">目次</a></h1><ul class="toc"><li><a href="#rfc.section.1">1.</a>   <a href="#rfc.section.1">はじめに</a><ul><li><a href="#rfc.section.1.1">1.1</a>   <a href="#rfc.section.1.1">概要</a></li><li><a href="#rfc.section.1.2">1.2</a>   <a href="#conventions">表記</a></li><li><a href="#rfc.section.1.3">1.3</a>   <a href="#encoding.concepts">用語</a></li></ul></li><li><a href="#rfc.section.2">2.</a>   <a href="#header.encoding">圧縮処理の概要</a><ul><li><a href="#rfc.section.2.1">2.1</a>   <a href="#header.list.ordering">ヘッダリストの順序</a></li><li><a href="#rfc.section.2.2">2.2</a>   <a href="#encoding.context">エンコーディングとデコーディングのコンテキスト</a></li><li><a href="#rfc.section.2.3">2.3</a>   <a href="#indexing.tables">インデックステーブル</a><ul><li><a href="#rfc.section.2.3.1">2.3.1</a>   <a href="#static.table">静的テーブル</a></li><li><a href="#rfc.section.2.3.2">2.3.2</a>   <a href="#dynamic.table">動的テーブル</a></li><li><a href="#rfc.section.2.3.3">2.3.3</a>   <a href="#index.address.space">インデックスアドレス空間</a></li></ul></li><li><a href="#rfc.section.2.4">2.4</a>   <a href="#header.representation">ヘッダフィールド表現</a></li></ul></li><li><a href="#rfc.section.3">3.</a>   <a href="#header.block.decoding">ヘッダブロックのデコード処理</a><ul><li><a href="#rfc.section.3.1">3.1</a>   <a href="#header.block.processing">ヘッダブロック処理</a></li><li><a href="#rfc.section.3.2">3.2</a>   <a href="#header.representation.processing">ヘッダフィールド表現の処理</a></li></ul></li><li><a href="#rfc.section.4">4.</a>   <a href="#dynamic.table.management">動的テーブルの管理</a><ul><li><a href="#rfc.section.4.1">4.1</a>   <a href="#calculating.table.size">テーブルサイズの計算</a></li><li><a href="#rfc.section.4.2">4.2</a>   <a href="#maximum.table.size">最大テーブルサイズ</a></li><li><a href="#rfc.section.4.3">4.3</a>   <a href="#entry.eviction">動的テーブルサイズ変更時のエントリの削除</a></li><li><a href="#rfc.section.4.4">4.4</a>   <a href="#entry.addition">新しいエントリ追加時のエントリの削除</a></li></ul></li><li><a href="#rfc.section.5">5.</a>   <a href="#low-level.representation">プリミティブ型表現</a><ul><li><a href="#rfc.section.5.1">5.1</a>   <a href="#integer.representation">整数表現</a></li><li><a href="#rfc.section.5.2">5.2</a>   <a href="#string.literal.representation">文字列リテラル表現</a></li></ul></li><li><a href="#rfc.section.6">6.</a>   <a href="#detailed.format">バイナリフォーマット</a><ul><li><a href="#rfc.section.6.1">6.1</a>   <a href="#indexed.header.representation">インデックスヘッダフィールド表現</a></li><li><a href="#rfc.section.6.2">6.2</a>   <a href="#literal.header.representation">リテラルヘッダフィールド表現</a><ul><li><a href="#rfc.section.6.2.1">6.2.1</a>   <a href="#literal.header.with.incremental.indexing">インデックス更新を伴うリテラルヘッダフィールド</a></li><li><a href="#rfc.section.6.2.2">6.2.2</a>   <a href="#literal.header.without.indexing">インデックス更新を伴わないリテラルヘッダフィールド</a></li><li><a href="#rfc.section.6.2.3">6.2.3</a>   <a href="#literal.header.never.indexed">インデックスされないリテラルヘッダフィールド</a></li></ul></li><li><a href="#rfc.section.6.3">6.3</a>   <a href="#encoding.context.update">動的テーブルサイズ更新</a></li></ul></li><li><a href="#rfc.section.7">7.</a>   <a href="#Security">セキュリティへの配慮</a><ul><li><a href="#rfc.section.7.1">7.1</a>   <a href="#compression.based.attacks">厳密な動的テーブルの状態</a><ul><li><a href="#rfc.section.7.1.1">7.1.1</a>   <a href="#rfc.section.7.1.1">HPACK と HTTP への適応性</a></li><li><a href="#rfc.section.7.1.2">7.1.2</a>   <a href="#rfc.section.7.1.2">緩和</a></li><li><a href="#rfc.section.7.1.3">7.1.3</a>   <a href="#never.indexed.literals">インデックスされないリテラル</a></li></ul></li><li><a href="#rfc.section.7.2">7.2</a>   <a href="#rfc.section.7.2">静的ハフマンエンコーディング</a></li><li><a href="#rfc.section.7.3">7.3</a>   <a href="#rfc.section.7.3">メモリ消費</a></li><li><a href="#rfc.section.7.4">7.4</a>   <a href="#rfc.section.7.4">実装上の制限</a></li></ul></li><li><a href="#rfc.section.8">8.</a>   <a href="#rfc.section.8">IANA への配慮</a></li><li><a href="#rfc.section.9">9.</a>   <a href="#rfc.section.9">謝辞</a></li><li><a href="#rfc.section.10">10.</a>   <a href="#rfc.references">参考文献</a><ul><li><a href="#rfc.section.10.1">10.1</a>   <a href="#rfc.references.1">引用文献</a></li><li><a href="#rfc.section.10.2">10.2</a>   <a href="#rfc.references.2">参考文献</a></li></ul></li><li><a href="#rfc.section.A">A.</a>   <a href="#static.table.definition">静的テーブル定義</a></li><li><a href="#rfc.section.B">B.</a>   <a href="#huffman.code">ハフマン符号</a></li><li><a href="#rfc.section.C">C.</a>   <a href="#examples">例</a><ul><li><a href="#rfc.section.C.1">C.1</a>   <a href="#integer.representation.examples">整数表現の例</a><ul><li><a href="#rfc.section.C.1.1">C.1.1</a>   <a href="#integer.representation.example1">例 1: 5 ビットプレフィックスを用いた 10 のエンコーディング</a></li><li><a href="#rfc.section.C.1.2">C.1.2</a>   <a href="#integer.representation.example2">例 2: 5 ビットプレフィックスを用いた 1337 のエンコーディング</a></li><li><a href="#rfc.section.C.1.3">C.1.3</a>   <a href="#integer.representation.example3">例 3: オクテット境界で開始する 42 のエンコーディング</a></li></ul></li><li><a href="#rfc.section.C.2">C.2</a>   <a href="#header.field.representation.examples">ヘッダフィールド表現の例</a><ul><li><a href="#rfc.section.C.2.1">C.2.1</a>   <a href="#rfc.section.C.2.1">インデックスを伴うリテラルヘッダフィールド</a></li><li><a href="#rfc.section.C.2.2">C.2.2</a>   <a href="#rfc.section.C.2.2">インデックスを伴わないリテラルヘッダフィールド</a></li><li><a href="#rfc.section.C.2.3">C.2.3</a>   <a href="#rfc.section.C.2.3">インデックスされないリテラルヘッダフィールド</a></li><li><a href="#rfc.section.C.2.4">C.2.4</a>   <a href="#rfc.section.C.2.4">インデックスヘッダフィールド</a></li></ul></li><li><a href="#rfc.section.C.3">C.3</a>   <a href="#request.examples.without.huffman.coding">ハフマン符号化を伴わないリクエストの例</a><ul><li><a href="#rfc.section.C.3.1">C.3.1</a>   <a href="#rfc.section.C.3.1">一個目のリクエスト</a></li><li><a href="#rfc.section.C.3.2">C.3.2</a>   <a href="#rfc.section.C.3.2">二個目のリクエスト</a></li><li><a href="#rfc.section.C.3.3">C.3.3</a>   <a href="#rfc.section.C.3.3">三個目のリクエスト</a></li></ul></li><li><a href="#rfc.section.C.4">C.4</a>   <a href="#request.examples.with.huffman.coding">ハフマン符号化を伴うリクエストの例</a><ul><li><a href="#rfc.section.C.4.1">C.4.1</a>   <a href="#rfc.section.C.4.1">一個目のリクエスト</a></li><li><a href="#rfc.section.C.4.2">C.4.2</a>   <a href="#rfc.section.C.4.2">二個目のリクエスト</a></li><li><a href="#rfc.section.C.4.3">C.4.3</a>   <a href="#rfc.section.C.4.3">三個目のリクエスト</a></li></ul></li><li><a href="#rfc.section.C.5">C.5</a>   <a href="#response.examples.without.huffman.coding">ハフマン符号化を伴わないレスポンスの例</a><ul><li><a href="#rfc.section.C.5.1">C.5.1</a>   <a href="#rfc.section.C.5.1">一個目のレスポンス</a></li><li><a href="#rfc.section.C.5.2">C.5.2</a>   <a href="#rfc.section.C.5.2">二個目のレスポンス</a></li><li><a href="#rfc.section.C.5.3">C.5.3</a>   <a href="#rfc.section.C.5.3">三個目のレスポンス</a></li></ul></li><li><a href="#rfc.section.C.6">C.6</a>   <a href="#response.examples.with.huffman.coding">ハフマン符号化を伴うレスポンスの例</a><ul><li><a href="#rfc.section.C.6.1">C.6.1</a>   <a href="#rfc.section.C.6.1">一個目のレスポンス</a></li><li><a href="#rfc.section.C.6.2">C.6.2</a>   <a href="#rfc.section.C.6.2">二個目のレスポンス</a></li><li><a href="#rfc.section.C.6.3">C.6.3</a>   <a href="#rfc.section.C.6.3">三個目のレスポンス</a></li></ul></li></ul></li><li><a href="#rfc.authors">Authors' Addresses</a></li></ul></div><ul class="toc"><li>Figures
        <ul><li><a href="#rfc.figure.1">Figure 1: インデックスアドレス空間</a></li><li><a href="#rfc.figure.2">Figure 2: プレフィックス内のエンコードされた整数値 (N = 5 の場合)</a></li><li><a href="#rfc.figure.3">Figure 3: Integer Value Encoded after the Prefix (shown for N = 5)</a></li><li><a href="#rfc.figure.4">Figure 4: 文字列リテラル表現</a></li><li><a href="#rfc.figure.5">Figure 5: インデックスヘッダフィールド</a></li><li><a href="#rfc.figure.6">Figure 6: インデックス更新を伴うリテラルヘッダフィールド - インデックスされた名前</a></li><li><a href="#rfc.figure.7">Figure 7: インデックス更新を伴うリテラルヘッダフィールド - 新しい名前</a></li><li><a href="#rfc.figure.8">Figure 8: インデックス更新を伴わないリテラルヘッダフィールド - インデックスされた名前</a></li><li><a href="#rfc.figure.9">Figure 9: インデックス更新を伴わないリテラルヘッダフィールド - 新しい名前</a></li><li><a href="#rfc.figure.10">Figure 10: インデックスされないリテラルヘッダフィールド - インデックスされた名前</a></li><li><a href="#rfc.figure.11">Figure 11: インデックスされないリテラルヘッダフィールド - 新しい名前</a></li><li><a href="#rfc.figure.12">Figure 12: 最大動的テーブルサイズの変更</a></li></ul></li></ul><div><h1 id="rfc.section.1" class="np"><a href="#rfc.section.1">1.</a> はじめに</h1><div id="rfc.section.1.p.1"><p>HTTP/1.1 (<a href="#RFC7230"><cite title="Hypertext Transfer Protocol (HTTP/1.1): Message Syntax and Routing">[RFC7230]</cite></a> を参照) において、 ヘッダフィールドは圧縮されません。 Web ページは 12 から数百の リクエストを含むようになってきており、これらのリクエストの中の 余分なヘッダフィールドは不必要に帯域を消費し、レイテンシを 大きく増加します。</p></div><div id="rfc.section.1.p.2"><p><a href="#SPDY">SPDY</a> <cite title="SPDY Protocol">[SPDY]</cite> は最初、余分なヘッダフィールド を効率的に表現することで非常に効率的にする <a href="#DEFLATE">DEFLATE</a> <cite title="DEFLATE Compressed Data Format Specification version 1.3">[DEFLATE]</cite> フォーマットを使用して ヘッダフィールドを圧縮することによりこの無駄に取り組みました。 しかしながら、このアプローチは CRIME 攻撃で実証された通り セキュリティリスクがあります。 (<a href="#CRIME"><cite title="The CRIME Attack">[CRIME]</cite></a>を参照)</p></div><div id="rfc.section.1.p.3"><p>この仕様書は余分なヘッダフィールドを消去し、既知のセキュリティ 攻撃への脆弱性を抑制し、そして制限された環境で使用する 制限されたメモリ要求を持つヘッダフィールドの新しい圧縮方式 HPACK を定義します。 HPACK の潜在的なセキュリティへの懸念は <a href="#Security" title="セキュリティへの配慮">Section 7</a> に記述します。</p></div><div id="rfc.section.1.p.4"><p>HPACK のフォーマットは意図的にシンプルで柔軟性を欠かせています。 この二つの特徴によって実装の誤りによる相互運用性とセキュリティ イシューのリスクを減らします。拡張メカニズムは定義されて いません。フォーマットの変更は完全な代替仕様の定義によって のみ成り立ちます。</p></div><div><h2 id="rfc.section.1.1"><a href="#rfc.section.1.1">1.1</a> 概要</h2><div id="rfc.section.1.1.p.1"><p>この仕様で定義されるフォーマットはヘッダフィールドのリストを 重複可能な名前と値のペアの順序付けられたコレクションとして扱います。 名前と値は不透明なオクテットの並びになることを考慮し、ヘッダ フィールドの順序は圧縮と展開の後で保存されます。</p></div><div id="rfc.section.1.1.p.2"><p>エンコーディングはヘッダフィールドとインデックスされた値を マップするヘッダフィールドテーブルによって決まります。これらの ヘッダフィールドテーブルは、新しいフィールドをエンコードもしくは デコードする時に増分更新を行えます。</p></div><div id="rfc.section.1.1.p.3"><p>エンコードされた形式内で、ヘッダフィールドはリテラルもしくは ヘッダフィールドテーブル内の一つのヘッダフィールドへの参照として表現 されます。従って、ヘッダフィールドのリストは参照とリテラル値を 混ぜ合わせてエンコードできます。</p></div><div id="rfc.section.1.1.p.4"><p>リテラル値は直接エンコードされるか静的なハフマン符号を 使います。</p></div><div id="rfc.section.1.1.p.5"><p>エンコーダはヘッダフィールドテーブルに新しいエントリとして挿入する ヘッダフィールドを決定する責任があります。デコーダは エンコーダによって定められたヘッダフィールドテーブルに対する修正を行い、 その処理内でヘッダフィールドのリストを再構築します。 これによりデコーダをシンプル化し、非常に様々なエンコーダと 相互運用可能にすることができます。</p></div><div id="rfc.section.1.1.p.6"><p>ヘッダフィールドを表現するためのこれらの異なったメカニズムの使用 を解説する例は <a href="#examples" title="例">Appendix C</a> にあります。</p></div></div><div id="conventions"><h2 id="rfc.section.1.2"><a href="#rfc.section.1.2">1.2</a> <a href="#conventions">表記</a></h2><div id="rfc.section.1.2.p.1"><p>この文書のキーワード "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT", "SHOULD", "SHOULD NOT", "RECOMMENDED", "MAY", そして "OPTIONAL" は <a href="#RFC2119">RFC 2119</a> <cite title="Key words for use in RFCs to Indicate Requirement Levels">[RFC2119]</cite> に記述された通りに解釈されます。</p></div><div id="rfc.section.1.2.p.2"><p>全ての数値はネットワークバイトオーダーです。特に断りが 無い限り値は符号なしです。リテラルの値は必要に応じて 10 進数または 16 進数で与えられます。</p></div></div><div id="encoding.concepts"><h2 id="rfc.section.1.3"><a href="#rfc.section.1.3">1.3</a> <a href="#encoding.concepts">用語</a></h2><div id="rfc.section.1.3.p.1"><p>この仕様は下記の用語を使用します: </p><dl><dt>ヘッダフィールド:</dt><dd>名前と値のペア。名前と値どちらも不定なオクテットの 連続として扱われます。</dd><dt>動的テーブル:</dt><dd>動的テーブル (<a href="#dynamic.table" title="動的テーブル">Section 2.3.2</a> を参照) は保存されたヘッダフィールドとインデックス 値を関連付けるのに使用されるテーブルです。 このテーブルは動的でエンコーディングやデコーディング のコンテキスト特有です。</dd><dt>静的テーブル:</dt><dd>静的テーブル(<a href="#static.table" title="静的テーブル">Section 2.3.1</a> を参照) は頻繁に使われるヘッダフィールドとインデックス値を静的に 関連づけるテーブルです。このテーブルは順序付けられ、 リードオンリーであり、常にアクセス可能で、すべての エンコーディングやデコーディングのコンテキストの間で共有される 可能性があります。</dd><dt>ヘッダリスト:</dt><dd>ヘッダリストは一緒にエンコードされるヘッダ フィールドの順序付けられたコレクションであり、重複した ヘッダフィールドを含むことができます。 HTTP/2 ヘッダブロックに含まれるヘッダフィールドの 完全なリストがヘッダリストです。</dd><dt>ヘッダフィールド表現:</dt><dd>ヘッダフィールドはリテラルかインデックスの どちらかのエンコードされた形式で表現できます。 (<a href="#header.representation" title="ヘッダフィールド表現">Section 2.4</a> を参照)</dd><dt>ヘッダブロック:</dt><dd>デコード時に完全なヘッダリストを提供する ヘッダフィールド表現の順序付けられたリストです。</dd></dl></div></div></div><div id="header.encoding"><h1 id="rfc.section.2"><a href="#rfc.section.2">2.</a> <a href="#header.encoding">圧縮処理の概要</a></h1><div id="rfc.section.2.p.1"><p>この仕様ではエンコーダの為の特定のアルゴリズムについては記述 しません。代わりに、デコーダがどう処理することが期待され、 この定義で許されるエンコーディングを行う為にエンコーダに許される ことを正確に定義します。</p></div><div id="header.list.ordering"><h2 id="rfc.section.2.1"><a href="#rfc.section.2.1">2.1</a> <a href="#header.list.ordering">ヘッダリストの順序</a></h2><div id="rfc.section.2.1.p.1"><p>HPACK はヘッダリスト内のヘッダフィールドの順序を保存します。 エンコーダはオリジナルのヘッダリスト内の順序に従ってヘッダ ブロックのヘッダフィールド表現を順序付けなければなりません (MUST) 。 デコーダはヘッダブロック内の順序によってデコードされたヘッダ リストのヘッダフィールドを順序付けなければなりません (MUST) 。</p></div></div><div id="encoding.context"><h2 id="rfc.section.2.2"><a href="#rfc.section.2.2">2.2</a> <a href="#encoding.context">エンコーディングとデコーディングのコンテキスト</a></h2><div id="rfc.section.2.2.p.1"><p>ヘッダブロックを展開するため、デコーダはデコーディング コンテキストとして動的テーブル (<a href="#dynamic.table" title="動的テーブル">Section 2.3.2</a> を参照) の 管理のみを必要とします。他に必要な状態はありません。</p></div><div id="rfc.section.2.2.p.2"><p>HTTP のような双方向コミュニケーションに使用される際、 エンコーディングとデコーディングの動的テーブルは 完全に独立したエンドポイントによって管理されます。 例えば、リクエストとレスポンスの動的テーブルは分離されます。</p></div></div><div id="indexing.tables"><h2 id="rfc.section.2.3"><a href="#rfc.section.2.3">2.3</a> <a href="#indexing.tables">インデックステーブル</a></h2><div id="rfc.section.2.3.p.1"><p>HPACK はヘッダフィールドとインデックスを関連付ける二つの テーブルを使用します。静的テーブル (<a href="#static.table" title="静的テーブル">Section 2.3.1</a> を参照) は 予め定義されており、 (ほとんどは空の値を持った) よく使用されるヘッダフィールドを 持ちます。動的テーブル (<a href="#dynamic.table" title="動的テーブル">Section 2.3.2</a> を 参照) は動的であり、エンコーダによってエンコードされた ヘッダリスト内で繰り返し使用されるヘッダフィールドを指すのに 使用できます。</p></div><div id="rfc.section.2.3.p.2"><p>これら二つのテーブルはインデックス値の定義のため単一のアドレス 空間内で結合されます。 (<a href="#index.address.space" title="インデックスアドレス空間">Section 2.3.3</a> を参照)</p></div><div id="static.table"><h3 id="rfc.section.2.3.1"><a href="#rfc.section.2.3.1">2.3.1</a> <a href="#static.table">静的テーブル</a></h3><div id="rfc.section.2.3.1.p.1"><p>静的テーブルは予め定義されたヘッダフィールドの静的 リストで構成されます。このエントリは <a href="#static.table.definition" title="静的テーブル定義">Appendix A</a> で定義 されます。</p></div></div><div id="dynamic.table"><h3 id="rfc.section.2.3.2"><a href="#rfc.section.2.3.2">2.3.2</a> <a href="#dynamic.table">動的テーブル</a></h3><div id="rfc.section.2.3.2.p.1"><p>動的テーブルは first-in, first-out 順で管理される ヘッダフィールドのリストで構成されます。動的テーブルの 最初であり最新のエントリは最小のインデックスに、最古の エントリは最大のインデックスになります。</p></div><div id="rfc.section.2.3.2.p.2"><p>動的テーブルは最初は空です。各ヘッダブロックとして追加 されるエントリは展開されています。</p></div><div id="rfc.section.2.3.2.p.3"><p>動的テーブルは重複するエントリ（例えば、同じ名前と 同じ値を持つエントリ）を持つことができます。 従って、重複したエントリはデコーダによってエラーとして 扱われてはいけません (MUST NOT) 。</p></div><div id="rfc.section.2.3.2.p.4"><p>エンコーダは動的テーブルの更新のしかたを決定するので、動的 テーブルに使用されるメモリ量を制御することができます。 デコーダのメモリ要件を制限するために、動的テーブルサイズは 厳密に束縛されます (<a href="#maximum.table.size" title="最大テーブルサイズ">Section 4.2</a> を 参照) 。</p></div><div id="rfc.section.2.3.2.p.5"><p>ヘッダフィールド表現のリストの処理中にデコーダは動的 テーブルを更新します。(<a href="#header.representation.processing" title="ヘッダフィールド表現の処理">Section 3.2</a> を参照)</p></div></div><div id="index.address.space"><h3 id="rfc.section.2.3.3"><a href="#rfc.section.2.3.3">2.3.3</a> <a href="#index.address.space">インデックスアドレス空間</a></h3><div id="rfc.section.2.3.3.p.1"><p>静的テーブルと動的テーブルは単一のインデックスアドレス 空間内で結合されます。</p></div><div id="rfc.section.2.3.3.p.2"><p>1 から静的テーブルの長さの間の指定は静的テーブル内の 要素を参照します (<a href="#static.table" title="静的テーブル">Section 2.3.1</a> を 参照) 。</p></div><div id="rfc.section.2.3.3.p.3"><p>静的テーブルの長さより大きい指定は動的テーブル (<a href="#dynamic.table" title="動的テーブル">Section 2.3.2</a> を参照) 内の 要素を参照します。静的テーブルの長さは動的テーブルの インデックスを検索するため差し引かれます。</p></div><div id="rfc.section.2.3.3.p.4"><p>両方のテーブルの長さの合計値より大きい指定はデコード エラーとして扱われなければなりません (MUST) 。</p></div><div id="Index.Address.Space"></div><div id="rfc.figure.1"><p>静的テーブルサイズ s 、動的テーブルサイズ k として、 下記の図は全体の有効なインデックスアドレス空間を 示しています。</p><pre class="drawing">
        &lt;----------  Index Address Space ----------&gt;
        &lt;-- Static  Table --&gt;  &lt;-- Dynamic Table --&gt;
        +---+-----------+---+  +---+-----------+---+
        | 1 |    ...    | s |  |s+1|    ...    |s+k|
        +---+-----------+---+  +---+-----------+---+
                               ^                   |
                               |                   V
                        Insertion Point      Dropping Point
</pre></div><p class="figure">Figure 1: インデックスアドレス空間</p></div></div><div id="header.representation"><h2 id="rfc.section.2.4"><a href="#rfc.section.2.4">2.4</a> <a href="#header.representation">ヘッダフィールド表現</a></h2><div id="rfc.section.2.4.p.1"><p>エンコードされたヘッダフィールドはインデックスもしくは リテラルで表現できます。</p></div><div id="rfc.section.2.4.p.2"><p>インデックス表現はヘッダフィールドを静的テーブルもしくは 動的テーブルのエントリへの参照として定義します。 (<a href="#indexed.header.representation" title="インデックスヘッダフィールド表現">Section 6.1</a> を参照)</p></div><div id="rfc.section.2.4.p.3"><p>リテラル表現は名前と値を指定することでヘッダフィールドを 定義します。ヘッダフィールド名はリテラル、もしくは静的テーブル または動的テーブルのエントリへの参照として表現できます。 ヘッダフィールド値はリテラルで表現されます。</p></div><div id="rfc.section.2.4.p.4"><p>3 つの異なるリテラル表現は下記のように定義されます: </p><ul><li>ヘッダフィールドを新しいエントリとして動的テーブルの 先頭に追加するリテラル表現 (<a href="#literal.header.with.incremental.indexing" title="インデックス更新を伴うリテラルヘッダフィールド">Section 6.2.1</a> を参照) 。</li><li>動的テーブルへのヘッダフィールドの追加を行わない リテラル表現 (<a href="#literal.header.without.indexing" title="インデックス更新を伴わないリテラルヘッダフィールド">Section 6.2.2</a> を参照) 。</li><li>特に中継者に再エンコードされる際に、ヘッダフィールドが 常にリテラル表現を使用するような追加条件を伴う、 動的テーブルへのヘッダフィールドの追加を行わない リテラル表現 (<a href="#literal.header.never.indexed" title="インデックスされないリテラルヘッダフィールド">Section 6.2.3</a> を参照) 。 この表現は圧縮によって危険にさらされないようヘッダフィールド値を 保護することを意図しています。 (詳細については <a href="#never.indexed.literals" title="インデックスされないリテラル">Section 7.1.3</a> を参照) 。</li></ul></div><div id="rfc.section.2.4.p.5"><p>3 つの表現から 1 つを選択するのは、センシティブなヘッダフィールド値を保護するため、 セキュリティ情の理由から導くことができます (<a href="#compression.based.attacks" title="厳密な動的テーブルの状態">Section 7.1</a> を参照) 。</p></div><div id="rfc.section.2.4.p.6"><p>ヘッダフィールド名とヘッダフィールド値のリテラル表現は そのままのものか静的ハフマン符号 (<a href="#string.literal.representation" title="文字列リテラル表現">Section 5.2</a> を参照) を用いたもののどちらかのオクテットの並びでエンコードできます。</p></div></div></div><div id="header.block.decoding"><h1 id="rfc.section.3"><a href="#rfc.section.3">3.</a> <a href="#header.block.decoding">ヘッダブロックのデコード処理</a></h1><div id="header.block.processing"><h2 id="rfc.section.3.1"><a href="#rfc.section.3.1">3.1</a> <a href="#header.block.processing">ヘッダブロック処理</a></h2><div id="rfc.section.3.1.p.1"><p>デコーダはオリジナルのヘッダリストを逐次的に再構成することで ヘッダブロックを処理します。</p></div><div id="rfc.section.3.1.p.2"><p>ヘッダブロックはヘッダフィールド表現を連結したものです。 含められるヘッダフィールド表現の違いは <a href="#detailed.format" title="バイナリフォーマット">Section 6</a> で 説明します。</p></div><div id="rfc.section.3.1.p.3"><p>いったんヘッダフィールドがデコードされ再構成されたヘッダ リストに追加されたら、そのヘッダフィールドは削除することはできません。 ヘッダリストに追加されたヘッダフィールドはアプリケーションに 安全に渡されます。</p></div><div id="rfc.section.3.1.p.4"><p>アプリケーションに結果のヘッダフィールドを渡すことで、 デコーダは動的テーブルの他に最低限の一時的なメモリ消費で 実装できます。</p></div></div><div id="header.representation.processing"><h2 id="rfc.section.3.2"><a href="#rfc.section.3.2">3.2</a> <a href="#header.representation.processing">ヘッダフィールド表現の処理</a></h2><div id="rfc.section.3.2.p.1"><p>ヘッダリストを得るためのヘッダブロックの処理をこの節で 定義します。デコード処理でうまくヘッダリストを生成する ことを確実にするため、デコーダは下記の規則に従わなければ なりません (MUST) 。</p></div><div id="rfc.section.3.2.p.2"><p>ヘッダブロックに含まれるすべてのヘッダフィールド表現は 下記に示す通り、現れた順に処理されます。様々なヘッダ フィールド表現のフォーマットの詳細と、追加の処理命令は <a href="#detailed.format" title="バイナリフォーマット">Section 6</a> にあります。</p></div><div id="rfc.section.3.2.p.3"><p><em>インデックス表現</em> は 下記のアクションを 伴います: </p><ul><li>静的テーブルもしくは動的テーブルの参照されるエントリに 対応するヘッダフィールドをデコード済みヘッダリストに 追加する。</li></ul></div><div id="rfc.section.3.2.p.4"><p>動的テーブルに <em>追加されていない</em> <em>リテラル表現</em> は下記のアクションを伴います: action: </p><ul><li>ヘッダフィールドをデコード済みヘッダリストに 追加する。</li></ul></div><div id="rfc.section.3.2.p.5"><p>動的テーブルに <em>追加されている</em> <em>リテラル表現</em> は下記のアクションを伴います: </p><ul><li>ヘッダフィールドをデコード済みヘッダリストに 追加する。</li><li>ヘッダフィールドは動的テーブルの先頭に挿入されます。 この挿入処理は動的テーブルの以前のエントリの削除を 引き起こす可能性があります (<a href="#entry.addition" title="新しいエントリ追加時のエントリの削除">Section 4.4</a> を参照) 。</li></ul></div></div></div><div id="dynamic.table.management"><h1 id="rfc.section.4"><a href="#rfc.section.4">4.</a> <a href="#dynamic.table.management">動的テーブルの管理</a></h1><div id="rfc.section.4.p.1"><p>デコーダ側のメモリ要件を制限するため、動的テーブルは サイズが制限されます。</p></div><div id="calculating.table.size"><h2 id="rfc.section.4.1"><a href="#rfc.section.4.1">4.1</a> <a href="#calculating.table.size">テーブルサイズの計算</a></h2><div id="rfc.section.4.1.p.1"><p>動的テーブルのサイズはそのエントリのサイズの合計値です。</p></div><div id="rfc.section.4.1.p.2"><p>エントリのサイズはその名前のオクテットの長さ (<a href="#string.literal.representation" title="文字列リテラル表現">Section 5.2</a> で定義される 通り) と値のオクテットの長さに 32 を加えた合計値です。</p></div><div id="rfc.section.4.1.p.3"><p>エントリのサイズはハフマンエンコーディングの適用無しの 名前と値の長さで計算されます。</p></div><div id="rfc.section.4.1.p.4"><dl><dt>注意:</dt><dd>エントリに関連付くオーバーヘッドとして追加の 32 オクテットを付加します。例として、エントリの名前と値を 参照するための 2 つの 64 ビットポインタと、名前と値への 参照数を数える 2 つの 64 ビット整数を使うエントリ構造 は 32 オクテットのオーバーヘッドを持ちます。</dd></dl></div></div><div id="maximum.table.size"><h2 id="rfc.section.4.2"><a href="#rfc.section.4.2">4.2</a> <a href="#maximum.table.size">最大テーブルサイズ</a></h2><div id="rfc.section.4.2.p.1"><p>HPACK を使用するプロトコルは、エンコーダが動的テーブルに 使用することが許可される最大サイズを決定します。 HTTP/2 に おいて、この値は SETTINGS_HEADER_TABLE_SIZE 設定 (<a href="#HTTP2"><cite title="Hypertext Transfer Protocol version 2">[HTTP2]</cite></a> の 6.5.2 節を 参照) で決定されます。</p></div><div id="rfc.section.4.2.p.2"><p>エンコーダはこの最大値より小さな容量を使用することを選択する ことが可能です (<a href="#encoding.context.update" title="動的テーブルサイズ更新">Section 6.3</a> を 参照) が、その値はプロトコルによって設定された最大値 以下に留めなければなりません (MUST) 。</p></div><div id="rfc.section.4.2.p.3"><p>動的テーブルの最大サイズの変更はエンコーディングコンテキスト更新 (<a href="#encoding.context.update" title="動的テーブルサイズ更新">Section 6.3</a> を参照) から通知されます。 エンコーディングコンテキスト更新は動的テーブルサイズの変更に続いて、最初の ヘッダブロックの先頭で行わなければなりません (MUST) 。 HTTP/2 において、これは設定同期 (<a href="#HTTP2"><cite title="Hypertext Transfer Protocol version 2">[HTTP2]</cite></a> の 6.5.3 節を 参照) で追従します。</p></div><div id="rfc.section.4.2.p.4"><p>二つのヘッダブロックの送信の間に複数のテーブルサイズの最大値の 更新が起こる可能性があります。この場合このサイズはこの区間内に 一度以上変更され、区間内に現れた最小の最大テーブルサイズが エンコーディングコンテキスト更新内で通知されなければなりません (MUST) 。 最終的な最大サイズは常に通知され、多くて二つのエンコーディングコンテキスト更新が 引き起こされます。これはデコーダがデコーダテーブルサイズに基づき 削除を実行することを可能にするのを確実にします (<a href="#entry.eviction" title="動的テーブルサイズ変更時のエントリの削除">Section 4.3</a> を参照) 。</p></div><div id="rfc.section.4.2.p.5"><p>このメカニズムで 0 の最大サイズを設定することで動的テーブル からエントリを完全にクリアして、その後に再格納することが できます。</p></div></div><div id="entry.eviction"><h2 id="rfc.section.4.3"><a href="#rfc.section.4.3">4.3</a> <a href="#entry.eviction">動的テーブルサイズ変更時のエントリの削除</a></h2><div id="rfc.section.4.3.p.1"><p>動的テーブルの最大サイズが減少するたびに、動的テーブルの サイズが最大サイズ以下になるまで動的テーブルの末尾から エントリが削除されます。</p></div></div><div id="entry.addition"><h2 id="rfc.section.4.4"><a href="#rfc.section.4.4">4.4</a> <a href="#entry.addition">新しいエントリ追加時のエントリの削除</a></h2><div id="rfc.section.4.4.p.1"><p>動的テーブルに新しいエントリが追加される前に、 動的テーブルのサイズが (最大サイズ - 新しいエントリサイズ) 以下になるかテーブルが空になるまで動的テーブルの末尾から エントリが削除されます。</p></div><div id="rfc.section.4.4.p.2"><p>もし新しいエントリのサイズが最大サイズ以下なら、エントリは テーブルに追加されます。最大サイズより大きいエントリの 追加を試みることはエラーにはなりません; 最大サイズより 大きなエントリの追加を試みるとすべてのエントリを空にすることに なり、テーブルを空にする結果になります。</p></div><div id="rfc.section.4.4.p.3"><p>動的テーブルに新しいエントリを追加する際、そのエントリは 削除される可能性のある動的テーブルのエントリの名前を参照する可能性があります。 新しいエントリを挿入する前に動的テーブルから参照されるエントリが 削除される場合、参照される名前を削除するのを避けるよう実装に注意してください。</p></div></div></div><div id="low-level.representation"><h1 id="rfc.section.5"><a href="#rfc.section.5">5.</a> <a href="#low-level.representation">プリミティブ型表現</a></h1><div id="rfc.section.5.p.1"><p>HPACK エンコーディングは二つのプリミティブ型を使用します: 符号なしの可変長整数と、オクテットの文字列</p></div><div id="integer.representation"><h2 id="rfc.section.5.1"><a href="#rfc.section.5.1">5.1</a> <a href="#integer.representation">整数表現</a></h2><div id="rfc.section.5.1.p.1"><p>整数は名前のインデックス、ヘッダフィールドのインデックスまたは 文字列の長さを表現するために使用されます。整数表現はオクテット内の どこからでも開始できます。処理の最適化のため、整数表現は常に オクテットの末尾で終わります。</p></div><div id="rfc.section.5.1.p.2"><p>整数は 2 つのパートで表現されます: 現在のオクテットを埋める プレフィックスとプレフィックス内に収まらない整数値のため 使用されるオクテットのオプションのリスト。プレフィックス のビット数 (N と呼ばれる) はこの整数表現のパラメータです。</p></div><div id="rfc.section.5.1.p.3"><p>整数値が十分小さい、すなわち 2^N-1 未満の 場合、 N ビットプレフィックス内にエンコードされます。</p></div><div id="Integer.Value.Encoded.within.the.Prefix.shown.for.N.5"></div><div id="rfc.figure.2"><pre class="inline">
  0   1   2   3   4   5   6   7
+---+---+---+---+---+---+---+---+
| ? | ? | ? |       Value       |
+---+---+---+-------------------+
</pre></div><p class="figure">Figure 2: プレフィックス内のエンコードされた整数値 (N = 5 の場合)</p><div id="rfc.section.5.1.p.4"><p>そうでない場合、プレフィックスの全てのビットが 1 ならその値は 2^N-1 分減らされ、一個以上の オクテットのリストを使用してエンコードされます。 各オクテットの最上位ビットは継続フラグとして使用されます: リストの最終オクテットを除きこの値には 1 がセットされます。 残りのオクテットのビットは残った値をエンコードするのに 使用されます。</p></div><div id="Integer.Value.Encoded.after.the.Prefix.shown.for.N.5"></div><div id="rfc.figure.3"><pre class="inline">
  0   1   2   3   4   5   6   7
+---+---+---+---+---+---+---+---+
| ? | ? | ? | 1   1   1   1   1 |
+---+---+---+-------------------+
| 1 |    Value-(2^N-1) LSB      |
+---+---------------------------+
               ...
+---+---------------------------+
| 0 |    Value-(2^N-1) MSB      |
+---+---------------------------+
</pre></div><p class="figure">Figure 3: Integer Value Encoded after the Prefix (shown for N = 5)</p><div id="rfc.section.5.1.p.5"><p>オクテットのリストからの整数値のデコード処理はリストの オクテットの逆順から開始します。その後、オクテット毎に 最上位ビットを除去します。オクテットの残りのビットは 連結され、その結果の値は整数値を得るために 2^N-1 分加算されます。</p></div><div id="rfc.section.5.1.p.6"><p>プレフィックスサイズ N は常に 1 から 8 ビットの間です。 オクテット境界から開始する整数は 8 ビットプレフィックスを 持ちます。</p></div><div id="rfc.figure.u.1"><p>整数 I を表現する擬似コードは下記の通り:</p><pre class="inline">
if I &lt; 2^N - 1, encode I on N bits
else
    encode (2^N - 1) on N bits
    I = I - (2^N - 1)
    while I &gt;= 128
         encode (I % 128 + 128) on 8 bits
         I = I / 128
    encode I on 8 bits
</pre></div><div id="rfc.figure.u.2"><p>整数 I をデコードする擬似コードは下記の通り:</p><pre class="inline">
decode I from the next N bits
if I &lt; 2^N - 1, return I
else
    M = 0
    repeat
        B = next octet
        I = I + (B &amp; 127) * 2^M
        M = M + 7
    while B &amp; 128 == 128
    return I
</pre></div><div id="rfc.section.5.1.p.7"><p>整数のエンコード処理を解説する例は <a href="#integer.representation.examples" title="整数表現の例">Appendix C.1</a> にあります。</p></div><div id="rfc.section.5.1.p.8"><p>この整数表現は不定サイズの値が許可されます。エンコーダは ゼロ値の巨大な数値を送ることも可能ですが、オクテットを浪費して 整数値のオーバーフローを起こす可能性があります。 値やオクテットの長さでの過度に巨大な整数のエンコードは デコードエラーとして扱われなければなりません (MUST) 。 制限の差異は実装上の制限に基づいて、各々の整数の使用方法の違いに 合わせることができます。</p></div></div><div id="string.literal.representation"><h2 id="rfc.section.5.2"><a href="#rfc.section.5.2">5.2</a> <a href="#string.literal.representation">文字列リテラル表現</a></h2><div id="rfc.section.5.2.p.1"><p>ヘッダフィールド名とヘッダフィールド値はリテラル文字列で 表現できます。リテラル文字列は文字列リテラルの オクテットに直接、もしくはハフマン符号 (<a href="#HUFFMAN"><cite title="A Method for the Construction of Minimum Redundancy Codes">[HUFFMAN]</cite></a> を参照) を 使用することでオクテットの連続としてエンコードされます。</p></div><div id="String.Literal.Representation"></div><div id="rfc.figure.4"><pre class="inline">
  0   1   2   3   4   5   6   7
+---+---+---+---+---+---+---+---+
| H |    String Length (7+)     |
+---+---------------------------+
|  String Data (Length octets)  |
+-------------------------------+
</pre></div><p class="figure">Figure 4: 文字列リテラル表現</p><div id="rfc.section.5.2.p.2"><p>リテラル文字列表現は下記のフィールドを含みます: </p><dl><dt>H:</dt><dd>1 ビットフラグ H 。文字列のオクテットがハフマン エンコーディングされているかどうかを示します。</dd><dt>String Length:</dt><dd>文字列リテラルをエンコードするのに使用された オクテットの数。 7 ビットプレフィックスの 整数としてエンコードされます。(<a href="#integer.representation" title="整数表現">Section 5.1</a> を参照)</dd><dt>String Data:</dt><dd>文字列リテラルのエンコードされたデータ。 もし H が '0' なら、エンコードされたデータは 文字列リテラルの生のオクテットです。もし H が '1' なら、エンコードされたデータは文字列リテラルを ハフマンエンコーディングされています。</dd></dl></div><div id="rfc.section.5.2.p.3"><p>ハフマンエンコーディングを使用する文字列リテラルは <a href="#huffman.code" title="ハフマン符号">Appendix B</a> で定義されるハフマン符号で エンコードされます。(リクエストの例として <a href="#request.examples.with.huffman.coding" title="ハフマン符号化を伴うリクエストの例">Appendix C.4</a> を、 レスポンスの例として <a href="#response.examples.with.huffman.coding" title="ハフマン符号化を伴うレスポンスの例">Appendix C.6</a> を 参照) エンコードされたデータは文字列リテラルの各 オクテットに対応する符号のビット列です。</p></div><div id="rfc.section.5.2.p.4"><p>ハフマンエンコードされたデータは常にオクテット境界で終わる わけではないので、その後に次のオクテット境界までパディングが 挿入されます。このパディングが文字列リテラルの一部だと誤認 されることを防ぐため、符号の最上位ビットに EOS (end-of-string) に対応するシンボルが使用されます。</p></div><div id="rfc.section.5.2.p.5"><p>デコーディングにおいて、エンコードされたデータの最後の 不完全なコードはパディングだとみなされ、破棄されます。 7 ビットより大きいパディングはデコードエラーとして 扱われなければなりません (MUST) 。 EOS シンボルのコードの 最上位ビットに対応しないパディングはデコードエラーとして 扱われなければなりません (MUST) 。 EOS シンボルを含む ハフマンエンコードされた文字列リテラルはデコードエラーとして 扱われなければなりません (MUST) 。</p></div></div></div><div id="detailed.format"><h1 id="rfc.section.6"><a href="#rfc.section.6">6.</a> <a href="#detailed.format">バイナリフォーマット</a></h1><div id="rfc.section.6.p.1"><p>この節では様々なヘッダフィールド表現の詳細フォーマット と、加えてエンコーディングコンテキストの更新命令について 記述します。</p></div><div id="indexed.header.representation"><h2 id="rfc.section.6.1"><a href="#rfc.section.6.1">6.1</a> <a href="#indexed.header.representation">インデックスヘッダフィールド表現</a></h2><div id="rfc.section.6.1.p.1"><p>インデックスヘッダフィールド表現は静的テーブル または動的テーブルのエントリを識別します。(<a href="#indexing.tables" title="インデックステーブル">Section 2.3</a> を参照)</p></div><div id="rfc.section.6.1.p.2"><p>インデックスヘッダフィールド表現は <a href="#header.representation.processing" title="ヘッダフィールド表現の処理">Section 3.2</a> で 記述した通り、デコードされたヘッダリストへのヘッダ フィールドの追加を発生させます。</p></div><div id="Indexed.Header.Field"></div><div id="rfc.figure.5"><pre class="inline">
  0   1   2   3   4   5   6   7
+---+---+---+---+---+---+---+---+
| 1 |        Index (7+)         |
+---+---------------------------+
</pre></div><p class="figure">Figure 5: インデックスヘッダフィールド</p><div id="rfc.section.6.1.p.3"><p>インデックスヘッダフィールドは 1 ビットパターン '1' から開始し、マッチするヘッダフィールドのインデックスが後に続きます。 インデックスは 7 ビットプレフィックスの整数として表現 されます (<a href="#integer.representation" title="整数表現">Section 5.1</a> を 参照) 。</p></div><div id="rfc.section.6.1.p.4"><p>0 のインデックス値は使用されません。もしインデックスヘッダ フィールド表現でこれが見つかった場合、デコードエラーとして 扱われなければなりません (MUST) 。</p></div></div><div id="literal.header.representation"><h2 id="rfc.section.6.2"><a href="#rfc.section.6.2">6.2</a> <a href="#literal.header.representation">リテラルヘッダフィールド表現</a></h2><div id="rfc.section.6.2.p.1"><p>リテラルヘッダフィールド表現はリテラルヘッダフィールド値を 含みます。ヘッダフィールド名はリテラル、もしくは静的テーブル か動的テーブルに存在するテーブルエントリへの参照として 与えられます。 (<a href="#indexing.tables" title="インデックステーブル">Section 2.3</a> を参照)</p></div><div id="rfc.section.6.2.p.2"><p>この仕様ではリテラルヘッダフィールド表現の 3 つの形式、 インデックスを伴う、インデックスを伴わない、インデックスしない ものを定義します。</p></div><div id="literal.header.with.incremental.indexing"><h3 id="rfc.section.6.2.1"><a href="#rfc.section.6.2.1">6.2.1</a> <a href="#literal.header.with.incremental.indexing">インデックス更新を伴うリテラルヘッダフィールド</a></h3><div id="rfc.section.6.2.1.p.1"><p>インデックス更新を伴うリテラルヘッダフィールド表現は デコードされたヘッダリストへのヘッダフィールドの追加と 動的テーブルへの新しいエントリの挿入を発生させます。</p></div><div id="Literal.Header.Field.with.Incremental.Indexing.Indexed.Name"></div><div id="rfc.figure.6"><pre class="inline">
  0   1   2   3   4   5   6   7
+---+---+---+---+---+---+---+---+
| 0 | 1 |      Index (6+)       |
+---+---+-----------------------+
| H |     Value Length (7+)     |
+---+---------------------------+
| Value String (Length octets)  |
+-------------------------------+
</pre></div><p class="figure">Figure 6: インデックス更新を伴うリテラルヘッダフィールド - インデックスされた名前</p><div id="Literal.Header.Field.with.Incremental.Indexing.New.Name"></div><div id="rfc.figure.7"><pre class="inline">
  0   1   2   3   4   5   6   7
+---+---+---+---+---+---+---+---+
| 0 | 1 |           0           |
+---+---+-----------------------+
| H |     Name Length (7+)      |
+---+---------------------------+
|  Name String (Length octets)  |
+---+---------------------------+
| H |     Value Length (7+)     |
+---+---------------------------+
| Value String (Length octets)  |
+-------------------------------+
</pre></div><p class="figure">Figure 7: インデックス更新を伴うリテラルヘッダフィールド - 新しい名前</p><div id="rfc.section.6.2.1.p.2"><p>インデックス更新を伴うリテラルヘッダフィールド表現は 2 ビットパターン '01' から開始します。</p></div><div id="rfc.section.6.2.1.p.3"><p>もし静的テーブルまたは動的テーブルに格納されたエントリの ヘッダフィールド名に、ヘッダフィールド名とマッチする場合、 ヘッダフィールド名はそのエントリのインデックスを用いて 表現できます。この場合、エントリのインデックスは 6 ビット プレフィックスの整数値として表現されます。 (<a href="#integer.representation" title="整数表現">Section 5.1</a> を参照) この値は常に非ゼロです。</p></div><div id="rfc.section.6.2.1.p.4"><p>そうでなければ、ヘッダフィールド名が文字列リテラル (<a href="#string.literal.representation" title="文字列リテラル表現">Section 5.2</a> を 参照) として表現されます。 6 ビットインデックスの 代わりに 0 値が使用され、ヘッダフィールド名が続きます。</p></div><div id="rfc.section.6.2.1.p.5"><p>どちらのヘッダフィールド名表現の形式も、文字列リテラル (<a href="#string.literal.representation" title="文字列リテラル表現">Section 5.2</a> を 参照) として表現されたヘッダフィールド値が続きます。</p></div></div><div id="literal.header.without.indexing"><h3 id="rfc.section.6.2.2"><a href="#rfc.section.6.2.2">6.2.2</a> <a href="#literal.header.without.indexing">インデックス更新を伴わないリテラルヘッダフィールド</a></h3><div id="rfc.section.6.2.2.p.1"><p>インデックス更新を伴わないリテラルヘッダフィールド表現は、 動的テーブルの変更を伴わずにデコードされたヘッダリストへの ヘッダフィールドの追加を引き起こします。</p></div><div id="Literal.Header.Field.without.Indexing.Indexed.Name"></div><div id="rfc.figure.8"><pre class="inline">
  0   1   2   3   4   5   6   7
+---+---+---+---+---+---+---+---+
| 0 | 0 | 0 | 0 |  Index (4+)   |
+---+---+-----------------------+
| H |     Value Length (7+)     |
+---+---------------------------+
| Value String (Length octets)  |
+-------------------------------+
</pre></div><p class="figure">Figure 8: インデックス更新を伴わないリテラルヘッダフィールド - インデックスされた名前</p><div id="Literal.Header.Field.without.Indexing.New.Name"></div><div id="rfc.figure.9"><pre class="inline">
  0   1   2   3   4   5   6   7
+---+---+---+---+---+---+---+---+
| 0 | 0 | 0 | 0 |       0       |
+---+---+-----------------------+
| H |     Name Length (7+)      |
+---+---------------------------+
|  Name String (Length octets)  |
+---+---------------------------+
| H |     Value Length (7+)     |
+---+---------------------------+
| Value String (Length octets)  |
+-------------------------------+
</pre></div><p class="figure">Figure 9: インデックス更新を伴わないリテラルヘッダフィールド - 新しい名前</p><div id="rfc.section.6.2.2.p.2"><p>インデックス更新を伴わないリテラルヘッダフィールド表現は 4 ビットパターン '0000' から開始します。</p></div><div id="rfc.section.6.2.2.p.3"><p>もし静的テーブルまたは動的テーブルに格納されたエントリの ヘッダフィールド名に、ヘッダフィールド名とマッチする場合、 ヘッダフィールド名はそのエントリのインデックスを用いて 表現できます。この場合、エントリのインデックスは 4 ビット プレフィックスの整数値として表現されます。 (<a href="#integer.representation" title="整数表現">Section 5.1</a> を参照) この値は常に非ゼロです。</p></div><div id="rfc.section.6.2.2.p.4"><p>そうでなければ、ヘッダフィールド名が文字列リテラル (<a href="#string.literal.representation" title="文字列リテラル表現">Section 5.2</a> を 参照) として表現されます。 4 ビットインデックスの 代わりに 0 値が使用され、ヘッダフィールド名が続きます。</p></div><div id="rfc.section.6.2.2.p.5"><p>どちらのヘッダフィールド名表現の形式も、文字列リテラル (<a href="#string.literal.representation" title="文字列リテラル表現">Section 5.2</a> を 参照) として表現されたヘッダフィールド値が続きます。</p></div></div><div id="literal.header.never.indexed"><h3 id="rfc.section.6.2.3"><a href="#rfc.section.6.2.3">6.2.3</a> <a href="#literal.header.never.indexed">インデックスされないリテラルヘッダフィールド</a></h3><div id="rfc.section.6.2.3.p.1"><p>インデックスされないリテラルヘッダフィールド表現は 動的テーブルの変更を伴わずにデコードされたヘッダリストへの ヘッダフィールドの追加を引き起こします。 中継者はこのヘッダフィールドのエンコードに同じ表現を 使用しなければなりません (MUST) 。</p></div><div id="Literal.Header.Field.never.Indexed.Indexed.Name"></div><div id="rfc.figure.10"><pre class="inline">
  0   1   2   3   4   5   6   7
+---+---+---+---+---+---+---+---+
| 0 | 0 | 0 | 1 |  Index (4+)   |
+---+---+-----------------------+
| H |     Value Length (7+)     |
+---+---------------------------+
| Value String (Length octets)  |
+-------------------------------+
</pre></div><p class="figure">Figure 10: インデックスされないリテラルヘッダフィールド - インデックスされた名前</p><div id="Literal.Header.Field.never.Indexed.New.Name"></div><div id="rfc.figure.11"><pre class="inline">
  0   1   2   3   4   5   6   7
+---+---+---+---+---+---+---+---+
| 0 | 0 | 0 | 1 |       0       |
+---+---+-----------------------+
| H |     Name Length (7+)      |
+---+---------------------------+
|  Name String (Length octets)  |
+---+---------------------------+
| H |     Value Length (7+)     |
+---+---------------------------+
| Value String (Length octets)  |
+-------------------------------+
</pre></div><p class="figure">Figure 11: インデックスされないリテラルヘッダフィールド - 新しい名前</p><div id="rfc.section.6.2.3.p.2"><p>インデックスされないリテラルヘッダフィールド表現は 4 ビットパターン '0001' から開始します。</p></div><div id="rfc.section.6.2.3.p.3"><p>ヘッダフィールドがインデックスされないリテラルヘッダ フィールドとして表現される際、常にこのリテラル表現で エンコードされなければなりません (MUST) 。特に、 ピアがインデックスされないリテラルヘッダフィールド として表現されたヘッダフィールドを受け取ってそれを 送信する際、そのヘッダフィールドを転送するのに同じ 表現を使用しなければなりません (MUST) 。</p></div><div id="rfc.section.6.2.3.p.4"><p>この表現は圧縮によるリスクに晒されないよう ヘッダフィールド値を保護することを意図しています (詳細は <a href="#compression.based.attacks" title="厳密な動的テーブルの状態">Section 7.1</a> を 参照) 。</p></div><div id="rfc.section.6.2.3.p.5"><p>この表現のエンコーディングはインデクシングを伴わない リテラルヘッダフィールドと同様です (<a href="#literal.header.without.indexing" title="インデックス更新を伴わないリテラルヘッダフィールド">Section 6.2.2</a> を 参照) 。</p></div></div></div><div id="encoding.context.update"><h2 id="rfc.section.6.3"><a href="#rfc.section.6.3">6.3</a> <a href="#encoding.context.update">動的テーブルサイズ更新</a></h2><div id="rfc.section.6.3.p.1"><p>動的テーブルサイズ更新は動的テーブルのサイズの変更を 通知します。</p></div><div id="Maximum.Dynamic.Table.Size.Change"></div><div id="rfc.figure.12"><pre class="inline">
  0   1   2   3   4   5   6   7
+---+---+---+---+---+---+---+---+
| 0 | 0 | 1 |   Max size (5+)   |
+---+---------------------------+
</pre></div><p class="figure">Figure 12: 最大動的テーブルサイズの変更</p><div id="rfc.section.6.3.p.2"><p>動的テーブルサイズ更新は 3 ビットパターン '001' から開始し、 5 ビットプレフィックスの整数値 (<a href="#integer.representation" title="整数表現">Section 5.1</a> を参照) として 表現される新しい最大値が続きます。</p></div><div id="rfc.section.6.3.p.3"><p>新しい最大値は HPACK を使用するプロトコルによって決められた 上限値以下でなければなりません (MUST) 。 この上限を超過した値はデコードエラーとして扱われなければ なりません (MUST) 。 HTTP/2 において、この上限は デコーダが受け取りエンコーダが知らせた (<a href="#HTTP2"><cite title="Hypertext Transfer Protocol version 2">[HTTP2]</cite></a> の 6.5.3 節を参照) SETTINGS_HEADER_TABLE_SIZE パラメータ (<a href="#HTTP2"><cite title="Hypertext Transfer Protocol version 2">[HTTP2]</cite></a> の 6.5.2 節を参照) の最後の値です。</p></div><div id="rfc.section.6.3.p.4"><p>動的テーブルの最大サイズの減少はエントリの削除を引き起こす 可能性があります。 (<a href="#entry.eviction" title="動的テーブルサイズ変更時のエントリの削除">Section 4.3</a> を 参照) 。</p></div></div></div><div id="Security"><h1 id="rfc.section.7"><a href="#rfc.section.7">7.</a> <a href="#Security">セキュリティへの配慮</a></h1><div id="rfc.section.7.p.1"><p>この節では HPACK の潜在的なセキュリティへの懸念部分について 記述します。 </p><ul><li>共有される圧縮コンテキストに混合される秘密情報についての推測の 検証のための長さを元にしたオラクルとしての圧縮の使用。</li><li>デコーダで処理やメモリ容量を消費することで引き起こされる サービス妨害。</li></ul></div><div id="compression.based.attacks"><h2 id="rfc.section.7.1"><a href="#rfc.section.7.1">7.1</a> <a href="#compression.based.attacks">厳密な動的テーブルの状態</a></h2><div id="rfc.section.7.1.p.1"><p>HPACK は HTTP のようなプロトコルで固有な冗長性を活用する ことによってエンコーディングをされたヘッダフィールドの長さを 減らします。この究極的なゴールは HTTP リクエストや レスポンスを送るために求められるデータの量を減らすことです。</p></div><div id="rfc.section.7.1.p.2"><p>ヘッダフィールドをエンコードするのに使用される圧縮 コンテキストは、エンコードし送信されるヘッダフィールドを 定義でき、一度エンコードされるフィールドの長さを 観測できる攻撃者によって探り当てられる可能性があります。 攻撃者がどちらも行える際、動的テーブルの状態に関する推測を 確認するためにリクエストをうまく修正することが可能です。 もし推測した値が短い長さに圧縮されるなら、攻撃者はエンコードされた 長さと推測した値が正しいという推量を確認できます。</p></div><div id="rfc.section.7.1.p.3"><p>これは トランスポートレイヤセキュリティプロトコル (TLS、 <a href="#TLS12"><cite title="The Transport Layer Security (TLS) Protocol Version 1.2">[TLS12]</cite></a> を参照) を用いても起こる可能性があります。なぜなら TLS がコンテンツの秘密保護を提供していても、そのコンテンツの 長さに関しては限られた保護のみしか提供されないためです。 </p><dl><dt>注意:</dt><dd>パティングスキームは推測の増加数を与えらた推測に 関連した長さを学習することのみ強制する可能性が あるような、これらの能力を持つ攻撃者に対する限られた 保護のみ提供します。 パディングスキームは送信されたビット数を増加することに よって圧縮に対しても直接作用します。</dd></dl></div><div id="rfc.section.7.1.p.4"><p><a href="#CRIME">CRIME</a> <cite title="The CRIME Attack">[CRIME]</cite> のような攻撃はこれらの 一般的な攻撃者の能力の存在を証明しています。 <a href="#DEFLATE">DEFLATE</a> <cite title="DEFLATE Compressed Data Format Specification version 1.3">[DEFLATE]</cite> の事実を悪用するこの 攻撃はプレフィックスマッチングに基づき冗長性を減らし ます。これは同時に攻撃者に文字の推測を検証する ことを許してしまい、指数関数時間の攻撃から線形時間の攻撃に してしまいます。</p></div><div><h3 id="rfc.section.7.1.1"><a href="#rfc.section.7.1.1">7.1.1</a> HPACK と HTTP への適応性</h3><div id="rfc.section.7.1.1.p.1"><p>HPACK は緩和はしますが全体のヘッダフィールド値ではなく 個々の文字をマッチさせることを推測値に強制することによる <a href="#CRIME">CRIME</a> <cite title="The CRIME Attack">[CRIME]</cite> に則った攻撃の完全な 防御はしません。攻撃者は推測値が正しいか否かのみを学習する ことができるため、ヘッダフィールド値の総当たり推測に 成り下がります。</p></div><div id="rfc.section.7.1.1.p.2"><p>特定のヘッダフィールド値の復元の可能性は、従って値の エントロピーに依存します。結果として、高エントロピーの 値はうまく復元される可能性は低くなります。しかしながら 低エントロピーの値は弱さが残ります。</p></div><div id="rfc.section.7.1.1.p.3"><p>この性質の攻撃は一つの HTTP/2 コネクション上で行われる 二つの互いに信用できないエンティティ制御リクエストと レスポンスの任意のタイミングで行えます。 もし共有の HPACK 実装が一つのエンティティに動的テーブルへの エントリの追加を許可し、他者がそのエントリにアクセス するなら、テーブルの状態を学習できます。</p></div><div id="rfc.section.7.1.1.p.4"><p>互いに信用できないエンティティからのリクエストと レスポンスがあるのは中継者がどちらかの時です: </p><ul><li>複数のクライアントからのリクエストを一つの コネクション上でオリジンサーバに送る、または</li><li>複数のオリジンサーバからのレスポンスを 共有された一つのコネクション上でクライアントに送る。</li></ul><p> Web ブラウザも異なる <a href="#ORIGIN">web オリジン</a> <cite title="The Web Origin Concept">[ORIGIN]</cite> によって同じコネクションで作成されるリクエストが互いに信用 できないエンティティによって作成されることを仮定する必要が あります。</p></div></div><div><h3 id="rfc.section.7.1.2"><a href="#rfc.section.7.1.2">7.1.2</a> 緩和</h3><div id="rfc.section.7.1.2.p.1"><p>ヘッダフィールドの機密性が求められる HTTP のユーザは 推測不可能にするのに十分なエントロピーを持つ値を 使用することができます。しかしながら、これは一般的な 解としては実用的ではありません。なぜならすべての HTTP のユーザに攻撃を緩和するためのステップを行う ことを強制することになるためです。 HTTP の使われ 方に新たな制約を加えることになります。</p></div><div id="rfc.section.7.1.2.p.2"><p>HTTP のユーザに制約を課すのではなく、 HPACK の実装は 動的テーブルの探り当ての可能性を制限するために圧縮の仕方を 制限することで代えることができます。</p></div><div id="rfc.section.7.1.2.p.3"><p>理想的な解は動的テーブルへのアクセスをヘッダフィールドを 構築するエンティティに基づいて分離することです。 テーブルに追加されるヘッダフィールド値はエンティティに 属し、その値を作成したエンティティのみが値を抽出 できます。</p></div><div id="rfc.section.7.1.2.p.4"><p>このオプションの圧縮性能を向上するため、信頼している エンティティは公開状態にタグ付けします。例えば、 web ブラウザは Accept-Encoding ヘッダフィールドの 値は全リクエストで使用可能にします。</p></div><div id="rfc.section.7.1.2.p.5"><p>ヘッダフィールドの出処の良い情報を持たないエンコーダは 代わりに、更なる推測を効率的に防ぐため、すべての将来の リクエストの懸念からすべての値が削除されることに なるヘッダフィールド値の推測を試みるような、 多くの異なる値をもつヘッダフィールドの報いを受ける可能性があります。 </p><dl><dt>Note:</dt><dd>もし攻撃者が値の再入を行える信頼できる経路を 持つ場合、動的テーブルからのヘッダフィールドに 対応するエントリの単純な削除では 不十分である可能性があります。例えば、 web ブラウザにおいて画像を読み込むための リクエストは典型的に Cookie ヘッダフィールド (この種類の攻撃で価値あるターゲットである可能性が 高い) を含み、 web サイトは簡単に画像が 読み込まれることを強制できるので、それによって 動的テーブルのエントリはリフレッシュされます。</dd></dl></div><div id="rfc.section.7.1.2.p.6"><p>このレスポンスはヘッダフィールドの長さと比較して 復元される場合があります。ヘッダフィールドを動的 テーブルを使わないようマークすることで短い値をより素早く、長い値より高い確率で 起こる可能性があります。</p></div></div><div id="never.indexed.literals"><h3 id="rfc.section.7.1.3"><a href="#rfc.section.7.1.3">7.1.3</a> <a href="#never.indexed.literals">インデックスされないリテラル</a></h3><div id="rfc.section.7.1.3.p.1"><p>実装は、圧縮せず代わりにリテラルとして値をエンコードすることで センシティブなヘッダフィールドを保護することを選ぶことも できます。</p></div><div id="rfc.section.7.1.3.p.2"><p>ヘッダフィールドのインデックス表現の生成を止める ことは圧縮がすべてのホップで行われない場合のみ 影響します。インデックスされないリテラル (<a href="#literal.header.never.indexed" title="インデックスされないリテラルヘッダフィールド">Section 6.2.3</a> を 参照) は中継者に特定の値が意図的にリテラルとして 送信されたことを通知するのに使用できます。</p></div><div id="rfc.section.7.1.3.p.3"><p>中継者はインデックスされないリテラル表現を使った値を 別のインデックスされる表現で再エンコードしては いけません (MUST NOT) 。 HPACK が再エンコードに使われる場合、 インデックスされないリテラル表現を使わなければなりません (MUST) 。</p></div><div id="rfc.section.7.1.3.p.4"><p>ヘッダフィールドにインデックスされないリテラル表現を 使用する選択は、幾つかの要因に依存します。 HPACK は 全体のヘッダフィールド値の推測に対抗する保護を行わないため、 短いかエントロピーの低い値は攻撃者によってより容易に復元しやすく なります。従って、エンコーダは低いエントロピーの値のインデックス を行わないことを選ぶこともできます。</p></div><div id="rfc.section.7.1.3.p.5"><p>エンコーダは Cookie や Authorization ヘッダフィールドのような、 重要でセンシティブなヘッダフィールドの復元を考慮して ヘッダフィールドの値のインデックスを行わないことを選ぶことも できます。</p></div><div id="rfc.section.7.1.3.p.6"><p>それどころか、エンコーダは露出される場合少しの値をもつ、 もしくは値のないヘッダフィールドの値をインデックスすることを 選ぶこともできます。例えば、 User-Agent ヘッダフィールドは リクエスト毎に変化することがなく、任意のサーバに送られます。 この場合、特に User-Agent に使われる値の確認は少ない値で 与えられます。</p></div><div id="rfc.section.7.1.3.p.7"><p>これらのインデックスされないリテラル表現の使用の決定基準は 新しい攻撃の発見により時間を経て発展する可能性があることに 注意してください。</p></div></div></div><div><h2 id="rfc.section.7.2"><a href="#rfc.section.7.2">7.2</a> 静的ハフマンエンコーディング</h2><div id="rfc.section.7.2.p.1"><p>静的ハフマンエンコーディングに対する現在知られている攻撃は ありません。静的ハフマンエンコーディングテーブルを用いる ことが情報漏えいを引き起こすことを示した研究がありますが、 攻撃者は意味のある情報を復元するためにこの情報漏えいを 利用することはできないと結論付けています (<a href="#PETAL"><cite title="PETAL: Preset Encoding Table Information Leakage">[PETAL]</cite></a> を参照) 。</p></div></div><div><h2 id="rfc.section.7.3"><a href="#rfc.section.7.3">7.3</a> メモリ消費</h2><div id="rfc.section.7.3.p.1"><p>攻撃者はエンドポイントがメモリを使い尽くすことを引き起こす ことを試みることができます。 HPACK はエンドポイントで 割り当てられたメモリ量のピークと状態を制限するよう設計 されています。</p></div><div id="rfc.section.7.3.p.2"><p>圧縮機によって使用されるメモリ量は、動的テーブルの 最大サイズの定義を通して HPACK を使用するプロトコルによって 制限されます。 HTTP/2 において、この値は設定パラメータ SETTINGS_HEADER_TABLE_SIZE (<a href="#HTTP2"><cite title="Hypertext Transfer Protocol version 2">[HTTP2]</cite></a> を通して デコーダによって制御されます。 この制限は動的テーブルに格納されるデータのサイズと、 加えてオーバーヘッドへの少しの配慮の両方を考慮しています。</p></div><div id="rfc.section.7.3.p.3"><p>デコーダは動的テーブルの最大サイズとして適切な 値を設定することで状態メモリの量を制限できます。 HTTP/2 において、 SETTINGS_HEADER_TABLE_SIZE パラメータに適切な 値を設定することで実現されます。 エンコーダはデコーダに許可された値未満の動的テーブル サイズを通知することで使用する状態メモリの量を制限できます。 (<a href="#encoding.context.update" title="動的テーブルサイズ更新">Section 6.3</a> を参照)</p></div><div id="rfc.section.7.3.p.4"><p>エンコーダやデコーダで消費される一時メモリ量は ヘッダフィールドを連続的に処理することで制限できます。 実装はヘッダフィールドの完全なリストを保持する必要は ありません。しかしながら他の理由のため完全なヘッダリストを 保持することがアプリケーションによっては必要になるかも しれないことに注意してください; HPACK がこれを強制して いないにも関わらず、アプリケーションの制限はこれを必要と するかもしれません。</p></div></div><div><h2 id="rfc.section.7.4"><a href="#rfc.section.7.4">7.4</a> 実装上の制限</h2><div id="rfc.section.7.4.p.1"><p>HPACK の実装は整数のための巨大な値、整数や長い文字列 リテラルのための長いエンコーディングがセキュリティの弱点を 生まないことを確実にすることが必要です。</p></div><div id="rfc.section.7.4.p.2"><p>実装はエンコードされた長さ (<a href="#integer.representation" title="整数表現">Section 5.1</a> を参照)と 同様、整数として受け入れる値を制限しなければ なりません。同様に、文字列リテラル(<a href="#string.literal.representation" title="文字列リテラル表現">Section 5.2</a> を参照) として受け入れる長さを制限しなければなりません。</p></div></div></div><div><h1 id="rfc.section.8"><a href="#rfc.section.8">8.</a> IANA への配慮</h1><div id="rfc.section.8.p.1"><p>このドキュメントには IANA アクションはありません。</p></div></div><div><h1 id="rfc.section.9"><a href="#rfc.section.9">9.</a> 謝辞</h1><div id="rfc.section.9.p.1"><p>この仕様は下記の個人から得た有益な情報を含んでいます: </p><ul><li>Mike Bishop, Jeff Pinner, Julian Reschke, Martin Thomson (価値ある編集上の貢献).</li><li>Johnny Graettinger (ハフマン符号統計).</li></ul></div></div><h1 id="rfc.references"><a id="rfc.section.10" href="#rfc.section.10">10.</a> 参考文献</h1><h2 id="rfc.references.1"><a href="#rfc.section.10.1" id="rfc.section.10.1">10.1</a> 引用文献</h2><table><tr><td class="reference"><b id="HTTP2">[HTTP2]</b></td><td class="top">Belshe, M., Peon, R., and M. Thomson, Ed., “<a href="https://tools.ietf.org/html/draft-ietf-httpbis-http2-17">Hypertext Transfer Protocol version 2</a>”, Internet-Draft draft-ietf-httpbis-http2-17 (work in progress), February 2015.</td></tr><tr><td class="reference"><b id="RFC2119">[RFC2119]</b></td><td class="top">Bradner, S., “<a href="http://www.rfc-editor.org/info/rfc2119">Key words for use in RFCs to Indicate Requirement Levels</a>”, BCP 14, RFC 2119, March 1997, &lt;<a href="http://www.rfc-editor.org/info/rfc2119">http://www.rfc-editor.org/info/rfc2119</a>&gt;.</td></tr><tr><td class="reference"><b id="RFC7230">[RFC7230]</b></td><td class="top">Fielding, R., Ed. and J. Reschke, Ed., “<a href="http://www.rfc-editor.org/info/rfc7230">Hypertext Transfer Protocol (HTTP/1.1): Message Syntax and Routing</a>”, RFC 7230, June 2014, &lt;<a href="http://www.rfc-editor.org/info/rfc7230">http://www.rfc-editor.org/info/rfc7230</a>&gt;.</td></tr></table><h2 id="rfc.references.2"><a href="#rfc.section.10.2" id="rfc.section.10.2">10.2</a> 参考文献</h2><table><tr><td class="reference"><b id="CANONICAL">[CANONICAL]</b></td><td class="top">Schwartz, E. and B. Kallick, “<a href="https://dl.acm.org/citation.cfm?id=363991">Generating a canonical prefix encoding</a>”, Communications of the ACM Volume 7 Issue 3, pp. 166-169, March 1964, &lt;<a href="https://dl.acm.org/citation.cfm?id=363991">https://dl.acm.org/citation.cfm?id=363991</a>&gt;.</td></tr><tr><td class="reference"><b id="CRIME">[CRIME]</b></td><td class="top">Rizzo, J. and T. Duong, “<a href="https://docs.google.com/a/twist.com/presentation/d/11eBmGiHbYcHR9gL5nDyZChu_-lCa2GizeuOfaLU2HOU">The CRIME Attack</a>”, September 2012, &lt;<a href="https://docs.google.com/a/twist.com/presentation/d/11eBmGiHbYcHR9gL5nDyZChu_-lCa2GizeuOfaLU2HOU">https://docs.google.com/a/twist.com/presentation/d/11eBmGiHbYcHR9gL5nDyZChu_-lCa2GizeuOfaLU2HOU</a>&gt;.</td></tr><tr><td class="reference"><b id="DEFLATE">[DEFLATE]</b></td><td class="top">Deutsch, P., “<a href="http://www.rfc-editor.org/info/rfc1951">DEFLATE Compressed Data Format Specification version 1.3</a>”, RFC 1951, May 1996, &lt;<a href="http://www.rfc-editor.org/info/rfc1951">http://www.rfc-editor.org/info/rfc1951</a>&gt;.</td></tr><tr><td class="reference"><b id="HUFFMAN">[HUFFMAN]</b></td><td class="top">Huffman, D., “<a href="http://ieeexplore.ieee.org/xpl/articleDetails.jsp?arnumber=4051119">A Method for the Construction of Minimum Redundancy Codes</a>”, Proceedings of the Institute of Radio Engineers Volume 40, Number 9, pp. 1098-1101, September 1952, &lt;<a href="http://ieeexplore.ieee.org/xpl/articleDetails.jsp?arnumber=4051119">http://ieeexplore.ieee.org/xpl/articleDetails.jsp?arnumber=4051119</a>&gt;.</td></tr><tr><td class="reference"><b id="ORIGIN">[ORIGIN]</b></td><td class="top">Barth, A., “<a href="http://www.rfc-editor.org/info/rfc6454">The Web Origin Concept</a>”, RFC 6454, December 2011, &lt;<a href="http://www.rfc-editor.org/info/rfc6454">http://www.rfc-editor.org/info/rfc6454</a>&gt;.</td></tr><tr><td class="reference"><b id="PETAL">[PETAL]</b></td><td class="top">Tan, J. and J. Nahata, “<a href="http://www.pdl.cmu.edu/PDL-FTP/associated/CMU-PDL-13-106.pdf">PETAL: Preset Encoding Table Information Leakage</a>”, April 2013, &lt;<a href="http://www.pdl.cmu.edu/PDL-FTP/associated/CMU-PDL-13-106.pdf">http://www.pdl.cmu.edu/PDL-FTP/associated/CMU-PDL-13-106.pdf</a>&gt;.</td></tr><tr><td class="reference"><b id="SPDY">[SPDY]</b></td><td class="top">Belshe, M. and R. Peon, “<a href="https://tools.ietf.org/html/draft-mbelshe-httpbis-spdy-00">SPDY Protocol</a>”, Internet-Draft draft-mbelshe-httpbis-spdy-00 (work in progress), February 2012.</td></tr><tr><td class="reference"><b id="TLS12">[TLS12]</b></td><td class="top">Dierks, T. and E. Rescorla, “<a href="http://www.rfc-editor.org/info/rfc5246">The Transport Layer Security (TLS) Protocol Version 1.2</a>”, RFC 5246, August 2008, &lt;<a href="http://www.rfc-editor.org/info/rfc5246">http://www.rfc-editor.org/info/rfc5246</a>&gt;.</td></tr></table><div id="static.table.definition"><h1 id="rfc.section.A" class="np"><a href="#rfc.section.A">A.</a> <a href="#static.table.definition">静的テーブル定義</a></h1><div id="rfc.section.A.p.1"><p>静的テーブル (<a href="#static.table" title="静的テーブル">Section 2.3.1</a> を参照) は 予め定義されており変更不可能なヘッダフィールドのリストで 構成されます。</p></div><div id="rfc.section.A.p.2"><p>静的テーブルは HTTP/2 特有の疑似ヘッダフィールド (<a href="#HTTP2"><cite title="Hypertext Transfer Protocol version 2">[HTTP2]</cite></a> 8.1.2.1 節を参照) の追加を伴った、 有名な web サイトで最も頻繁に使用されたヘッダフィールドから 作成されました。少数のヘッダフィールドの値は頻繁に使用される値として エントリに追加されています。その他のヘッダフィールドは、空の値で 追加されています。</p></div><div id="rfc.section.A.p.3"><p>下記のテーブルは静的テーブルを構成する予め定義されたヘッダ フィールドを列挙しています。</p></div><div id="rfc.table.1"><div id="static.table.entries"></div><table class="tt full center" cellpadding="3" cellspacing="0"><caption>Table 1: 静的テーブルエントリ</caption><thead><tr><th>インデックス</th><th>ヘッダ名</th><th>ヘッダ値</th></tr></thead><tbody><tr><td class="left">1</td><td class="left">:authority</td><td class="left"></td></tr><tr><td class="left">2</td><td class="left">:method</td><td class="left">GET</td></tr><tr><td class="left">3</td><td class="left">:method</td><td class="left">POST</td></tr><tr><td class="left">4</td><td class="left">:path</td><td class="left">/</td></tr><tr><td class="left">5</td><td class="left">:path</td><td class="left">/index.html</td></tr><tr><td class="left">6</td><td class="left">:scheme</td><td class="left">http</td></tr><tr><td class="left">7</td><td class="left">:scheme</td><td class="left">https</td></tr><tr><td class="left">8</td><td class="left">:status</td><td class="left">200</td></tr><tr><td class="left">9</td><td class="left">:status</td><td class="left">204</td></tr><tr><td class="left">10</td><td class="left">:status</td><td class="left">206</td></tr><tr><td class="left">11</td><td class="left">:status</td><td class="left">304</td></tr><tr><td class="left">12</td><td class="left">:status</td><td class="left">400</td></tr><tr><td class="left">13</td><td class="left">:status</td><td class="left">404</td></tr><tr><td class="left">14</td><td class="left">:status</td><td class="left">500</td></tr><tr><td class="left">15</td><td class="left">accept-charset</td><td class="left"></td></tr><tr><td class="left">16</td><td class="left">accept-encoding</td><td class="left">gzip, deflate</td></tr><tr><td class="left">17</td><td class="left">accept-language</td><td class="left"></td></tr><tr><td class="left">18</td><td class="left">accept-ranges</td><td class="left"></td></tr><tr><td class="left">19</td><td class="left">accept</td><td class="left"></td></tr><tr><td class="left">20</td><td class="left">access-control-allow-origin</td><td class="left"></td></tr><tr><td class="left">21</td><td class="left">age</td><td class="left"></td></tr><tr><td class="left">22</td><td class="left">allow</td><td class="left"></td></tr><tr><td class="left">23</td><td class="left">authorization</td><td class="left"></td></tr><tr><td class="left">24</td><td class="left">cache-control</td><td class="left"></td></tr><tr><td class="left">25</td><td class="left">content-disposition</td><td class="left"></td></tr><tr><td class="left">26</td><td class="left">content-encoding</td><td class="left"></td></tr><tr><td class="left">27</td><td class="left">content-language</td><td class="left"></td></tr><tr><td class="left">28</td><td class="left">content-length</td><td class="left"></td></tr><tr><td class="left">29</td><td class="left">content-location</td><td class="left"></td></tr><tr><td class="left">30</td><td class="left">content-range</td><td class="left"></td></tr><tr><td class="left">31</td><td class="left">content-type</td><td class="left"></td></tr><tr><td class="left">32</td><td class="left">cookie</td><td class="left"></td></tr><tr><td class="left">33</td><td class="left">date</td><td class="left"></td></tr><tr><td class="left">34</td><td class="left">etag</td><td class="left"></td></tr><tr><td class="left">35</td><td class="left">expect</td><td class="left"></td></tr><tr><td class="left">36</td><td class="left">expires</td><td class="left"></td></tr><tr><td class="left">37</td><td class="left">from</td><td class="left"></td></tr><tr><td class="left">38</td><td class="left">host</td><td class="left"></td></tr><tr><td class="left">39</td><td class="left">if-match</td><td class="left"></td></tr><tr><td class="left">40</td><td class="left">if-modified-since</td><td class="left"></td></tr><tr><td class="left">41</td><td class="left">if-none-match</td><td class="left"></td></tr><tr><td class="left">42</td><td class="left">if-range</td><td class="left"></td></tr><tr><td class="left">43</td><td class="left">if-unmodified-since</td><td class="left"></td></tr><tr><td class="left">44</td><td class="left">last-modified</td><td class="left"></td></tr><tr><td class="left">45</td><td class="left">link</td><td class="left"></td></tr><tr><td class="left">46</td><td class="left">location</td><td class="left"></td></tr><tr><td class="left">47</td><td class="left">max-forwards</td><td class="left"></td></tr><tr><td class="left">48</td><td class="left">proxy-authenticate</td><td class="left"></td></tr><tr><td class="left">49</td><td class="left">proxy-authorization</td><td class="left"></td></tr><tr><td class="left">50</td><td class="left">range</td><td class="left"></td></tr><tr><td class="left">51</td><td class="left">referer</td><td class="left"></td></tr><tr><td class="left">52</td><td class="left">refresh</td><td class="left"></td></tr><tr><td class="left">53</td><td class="left">retry-after</td><td class="left"></td></tr><tr><td class="left">54</td><td class="left">server</td><td class="left"></td></tr><tr><td class="left">55</td><td class="left">set-cookie</td><td class="left"></td></tr><tr><td class="left">56</td><td class="left">strict-transport-security</td><td class="left"></td></tr><tr><td class="left">57</td><td class="left">transfer-encoding</td><td class="left"></td></tr><tr><td class="left">58</td><td class="left">user-agent</td><td class="left"></td></tr><tr><td class="left">59</td><td class="left">vary</td><td class="left"></td></tr><tr><td class="left">60</td><td class="left">via</td><td class="left"></td></tr><tr><td class="left">61</td><td class="left">www-authenticate</td><td class="left"></td></tr></tbody></table></div><div id="rfc.section.A.p.4"><p><a href="#static.table.entries">Table 1</a> は静的テーブル内の 各エントリのインデックスを与えます。</p></div></div><div id="huffman.code"><h1 id="rfc.section.B"><a href="#rfc.section.B">B.</a> <a href="#huffman.code">ハフマン符号</a></h1><div id="rfc.section.B.p.1"><p>下記のハフマン符号はハフマン符号化を伴う文字列リテラルの エンコーディング時に使用されます(<a href="#string.literal.representation" title="文字列リテラル表現">Section 5.2</a> を参照)。</p></div><div id="rfc.section.B.p.2"><p>このハフマン符号は HTTP ヘッダの多くのサンプルで得られた 統計から生成されました。これはユニークなコード長を持つシンボルが 無いことを確実にするよう幾つかの微調整を行ったカノニカルハフマン 符号 (<a href="#CANONICAL"><cite title="Generating a canonical prefix encoding">[CANONICAL]</cite></a> を参照) です。</p></div><div id="rfc.section.B.p.3"><p>テーブルの各行はシンボルを表現するのに使用されるコードを定義します: </p><dl><dt>sym:</dt><dd>表現されるシンボル。オクテットの 10 進数値です。可能で あればアスキー表現でも表記しています。特別なシンボル "EOS" は文字列リテラルの終わりを示すのに使用されます。</dd><dt>code as bits:</dt><dd>2 進数で表現されたシンボルのハフマンコード。 最上位ビット (MSB) で調整されています。</dd><dt>code as hex:</dt><dd>16 進数で表現されたシンボルのハフマンコード。 最下位ビット (LSB) で調整されています。</dd><dt>len:</dt><dd>シンボルを表現するコードのビット数。</dd></dl></div><div id="rfc.section.B.p.4"><p>例として、シンボル 47 (アスキー文字 "/" に対応します) のコードは 6 ビット "0", "1", "1", "0", "0", "0" から構成されます。 これは 6 ビットでエンコードされた値 0x18 (16 進数で) に対応します。</p></div><div id="rfc.figure.u.3"><pre>
                                                     code
                       code as bits                 as hex   len
     sym              aligned to MSB                aligned   in
                                                    to LSB   bits
    (  0)  |11111111|11000                             1ff8  [13]
    (  1)  |11111111|11111111|1011000                7fffd8  [23]
    (  2)  |11111111|11111111|11111110|0010         fffffe2  [28]
    (  3)  |11111111|11111111|11111110|0011         fffffe3  [28]
    (  4)  |11111111|11111111|11111110|0100         fffffe4  [28]
    (  5)  |11111111|11111111|11111110|0101         fffffe5  [28]
    (  6)  |11111111|11111111|11111110|0110         fffffe6  [28]
    (  7)  |11111111|11111111|11111110|0111         fffffe7  [28]
    (  8)  |11111111|11111111|11111110|1000         fffffe8  [28]
    (  9)  |11111111|11111111|11101010               ffffea  [24]
    ( 10)  |11111111|11111111|11111111|111100      3ffffffc  [30]
    ( 11)  |11111111|11111111|11111110|1001         fffffe9  [28]
    ( 12)  |11111111|11111111|11111110|1010         fffffea  [28]
    ( 13)  |11111111|11111111|11111111|111101      3ffffffd  [30]
    ( 14)  |11111111|11111111|11111110|1011         fffffeb  [28]
    ( 15)  |11111111|11111111|11111110|1100         fffffec  [28]
    ( 16)  |11111111|11111111|11111110|1101         fffffed  [28]
    ( 17)  |11111111|11111111|11111110|1110         fffffee  [28]
    ( 18)  |11111111|11111111|11111110|1111         fffffef  [28]
    ( 19)  |11111111|11111111|11111111|0000         ffffff0  [28]
    ( 20)  |11111111|11111111|11111111|0001         ffffff1  [28]
    ( 21)  |11111111|11111111|11111111|0010         ffffff2  [28]
    ( 22)  |11111111|11111111|11111111|111110      3ffffffe  [30]
    ( 23)  |11111111|11111111|11111111|0011         ffffff3  [28]
    ( 24)  |11111111|11111111|11111111|0100         ffffff4  [28]
    ( 25)  |11111111|11111111|11111111|0101         ffffff5  [28]
    ( 26)  |11111111|11111111|11111111|0110         ffffff6  [28]
    ( 27)  |11111111|11111111|11111111|0111         ffffff7  [28]
    ( 28)  |11111111|11111111|11111111|1000         ffffff8  [28]
    ( 29)  |11111111|11111111|11111111|1001         ffffff9  [28]
    ( 30)  |11111111|11111111|11111111|1010         ffffffa  [28]
    ( 31)  |11111111|11111111|11111111|1011         ffffffb  [28]
' ' ( 32)  |010100                                       14  [ 6]
'!' ( 33)  |11111110|00                                 3f8  [10]
'"' ( 34)  |11111110|01                                 3f9  [10]
'#' ( 35)  |11111111|1010                               ffa  [12]
'$' ( 36)  |11111111|11001                             1ff9  [13]
'%' ( 37)  |010101                                       15  [ 6]
'&amp;' ( 38)  |11111000                                     f8  [ 8]
''' ( 39)  |11111111|010                                7fa  [11]
'(' ( 40)  |11111110|10                                 3fa  [10]
')' ( 41)  |11111110|11                                 3fb  [10]
'*' ( 42)  |11111001                                     f9  [ 8]
'+' ( 43)  |11111111|011                                7fb  [11]
',' ( 44)  |11111010                                     fa  [ 8]
'-' ( 45)  |010110                                       16  [ 6]
'.' ( 46)  |010111                                       17  [ 6]
'/' ( 47)  |011000                                       18  [ 6]
'0' ( 48)  |00000                                         0  [ 5]
'1' ( 49)  |00001                                         1  [ 5]
'2' ( 50)  |00010                                         2  [ 5]
'3' ( 51)  |011001                                       19  [ 6]
'4' ( 52)  |011010                                       1a  [ 6]
'5' ( 53)  |011011                                       1b  [ 6]
'6' ( 54)  |011100                                       1c  [ 6]
'7' ( 55)  |011101                                       1d  [ 6]
'8' ( 56)  |011110                                       1e  [ 6]
'9' ( 57)  |011111                                       1f  [ 6]
':' ( 58)  |1011100                                      5c  [ 7]
';' ( 59)  |11111011                                     fb  [ 8]
'&lt;' ( 60)  |11111111|1111100                           7ffc  [15]
'=' ( 61)  |100000                                       20  [ 6]
'&gt;' ( 62)  |11111111|1011                               ffb  [12]
'?' ( 63)  |11111111|00                                 3fc  [10]
'@' ( 64)  |11111111|11010                             1ffa  [13]
'A' ( 65)  |100001                                       21  [ 6]
'B' ( 66)  |1011101                                      5d  [ 7]
'C' ( 67)  |1011110                                      5e  [ 7]
'D' ( 68)  |1011111                                      5f  [ 7]
'E' ( 69)  |1100000                                      60  [ 7]
'F' ( 70)  |1100001                                      61  [ 7]
'G' ( 71)  |1100010                                      62  [ 7]
'H' ( 72)  |1100011                                      63  [ 7]
'I' ( 73)  |1100100                                      64  [ 7]
'J' ( 74)  |1100101                                      65  [ 7]
'K' ( 75)  |1100110                                      66  [ 7]
'L' ( 76)  |1100111                                      67  [ 7]
'M' ( 77)  |1101000                                      68  [ 7]
'N' ( 78)  |1101001                                      69  [ 7]
'O' ( 79)  |1101010                                      6a  [ 7]
'P' ( 80)  |1101011                                      6b  [ 7]
'Q' ( 81)  |1101100                                      6c  [ 7]
'R' ( 82)  |1101101                                      6d  [ 7]
'S' ( 83)  |1101110                                      6e  [ 7]
'T' ( 84)  |1101111                                      6f  [ 7]
'U' ( 85)  |1110000                                      70  [ 7]
'V' ( 86)  |1110001                                      71  [ 7]
'W' ( 87)  |1110010                                      72  [ 7]
'X' ( 88)  |11111100                                     fc  [ 8]
'Y' ( 89)  |1110011                                      73  [ 7]
'Z' ( 90)  |11111101                                     fd  [ 8]
'[' ( 91)  |11111111|11011                             1ffb  [13]
'\' ( 92)  |11111111|11111110|000                     7fff0  [19]
']' ( 93)  |11111111|11100                             1ffc  [13]
'^' ( 94)  |11111111|111100                            3ffc  [14]
'_' ( 95)  |100010                                       22  [ 6]
'`' ( 96)  |11111111|1111101                           7ffd  [15]
'a' ( 97)  |00011                                         3  [ 5]
'b' ( 98)  |100011                                       23  [ 6]
'c' ( 99)  |00100                                         4  [ 5]
'd' (100)  |100100                                       24  [ 6]
'e' (101)  |00101                                         5  [ 5]
'f' (102)  |100101                                       25  [ 6]
'g' (103)  |100110                                       26  [ 6]
'h' (104)  |100111                                       27  [ 6]
'i' (105)  |00110                                         6  [ 5]
'j' (106)  |1110100                                      74  [ 7]
'k' (107)  |1110101                                      75  [ 7]
'l' (108)  |101000                                       28  [ 6]
'm' (109)  |101001                                       29  [ 6]
'n' (110)  |101010                                       2a  [ 6]
'o' (111)  |00111                                         7  [ 5]
'p' (112)  |101011                                       2b  [ 6]
'q' (113)  |1110110                                      76  [ 7]
'r' (114)  |101100                                       2c  [ 6]
's' (115)  |01000                                         8  [ 5]
't' (116)  |01001                                         9  [ 5]
'u' (117)  |101101                                       2d  [ 6]
'v' (118)  |1110111                                      77  [ 7]
'w' (119)  |1111000                                      78  [ 7]
'x' (120)  |1111001                                      79  [ 7]
'y' (121)  |1111010                                      7a  [ 7]
'z' (122)  |1111011                                      7b  [ 7]
'{' (123)  |11111111|1111110                           7ffe  [15]
'|' (124)  |11111111|100                                7fc  [11]
'}' (125)  |11111111|111101                            3ffd  [14]
'~' (126)  |11111111|11101                             1ffd  [13]
    (127)  |11111111|11111111|11111111|1100         ffffffc  [28]
    (128)  |11111111|11111110|0110                    fffe6  [20]
    (129)  |11111111|11111111|010010                 3fffd2  [22]
    (130)  |11111111|11111110|0111                    fffe7  [20]
    (131)  |11111111|11111110|1000                    fffe8  [20]
    (132)  |11111111|11111111|010011                 3fffd3  [22]
    (133)  |11111111|11111111|010100                 3fffd4  [22]
    (134)  |11111111|11111111|010101                 3fffd5  [22]
    (135)  |11111111|11111111|1011001                7fffd9  [23]
    (136)  |11111111|11111111|010110                 3fffd6  [22]
    (137)  |11111111|11111111|1011010                7fffda  [23]
    (138)  |11111111|11111111|1011011                7fffdb  [23]
    (139)  |11111111|11111111|1011100                7fffdc  [23]
    (140)  |11111111|11111111|1011101                7fffdd  [23]
    (141)  |11111111|11111111|1011110                7fffde  [23]
    (142)  |11111111|11111111|11101011               ffffeb  [24]
    (143)  |11111111|11111111|1011111                7fffdf  [23]
    (144)  |11111111|11111111|11101100               ffffec  [24]
    (145)  |11111111|11111111|11101101               ffffed  [24]
    (146)  |11111111|11111111|010111                 3fffd7  [22]
    (147)  |11111111|11111111|1100000                7fffe0  [23]
    (148)  |11111111|11111111|11101110               ffffee  [24]
    (149)  |11111111|11111111|1100001                7fffe1  [23]
    (150)  |11111111|11111111|1100010                7fffe2  [23]
    (151)  |11111111|11111111|1100011                7fffe3  [23]
    (152)  |11111111|11111111|1100100                7fffe4  [23]
    (153)  |11111111|11111110|11100                  1fffdc  [21]
    (154)  |11111111|11111111|011000                 3fffd8  [22]
    (155)  |11111111|11111111|1100101                7fffe5  [23]
    (156)  |11111111|11111111|011001                 3fffd9  [22]
    (157)  |11111111|11111111|1100110                7fffe6  [23]
    (158)  |11111111|11111111|1100111                7fffe7  [23]
    (159)  |11111111|11111111|11101111               ffffef  [24]
    (160)  |11111111|11111111|011010                 3fffda  [22]
    (161)  |11111111|11111110|11101                  1fffdd  [21]
    (162)  |11111111|11111110|1001                    fffe9  [20]
    (163)  |11111111|11111111|011011                 3fffdb  [22]
    (164)  |11111111|11111111|011100                 3fffdc  [22]
    (165)  |11111111|11111111|1101000                7fffe8  [23]
    (166)  |11111111|11111111|1101001                7fffe9  [23]
    (167)  |11111111|11111110|11110                  1fffde  [21]
    (168)  |11111111|11111111|1101010                7fffea  [23]
    (169)  |11111111|11111111|011101                 3fffdd  [22]
    (170)  |11111111|11111111|011110                 3fffde  [22]
    (171)  |11111111|11111111|11110000               fffff0  [24]
    (172)  |11111111|11111110|11111                  1fffdf  [21]
    (173)  |11111111|11111111|011111                 3fffdf  [22]
    (174)  |11111111|11111111|1101011                7fffeb  [23]
    (175)  |11111111|11111111|1101100                7fffec  [23]
    (176)  |11111111|11111111|00000                  1fffe0  [21]
    (177)  |11111111|11111111|00001                  1fffe1  [21]
    (178)  |11111111|11111111|100000                 3fffe0  [22]
    (179)  |11111111|11111111|00010                  1fffe2  [21]
    (180)  |11111111|11111111|1101101                7fffed  [23]
    (181)  |11111111|11111111|100001                 3fffe1  [22]
    (182)  |11111111|11111111|1101110                7fffee  [23]
    (183)  |11111111|11111111|1101111                7fffef  [23]
    (184)  |11111111|11111110|1010                    fffea  [20]
    (185)  |11111111|11111111|100010                 3fffe2  [22]
    (186)  |11111111|11111111|100011                 3fffe3  [22]
    (187)  |11111111|11111111|100100                 3fffe4  [22]
    (188)  |11111111|11111111|1110000                7ffff0  [23]
    (189)  |11111111|11111111|100101                 3fffe5  [22]
    (190)  |11111111|11111111|100110                 3fffe6  [22]
    (191)  |11111111|11111111|1110001                7ffff1  [23]
    (192)  |11111111|11111111|11111000|00           3ffffe0  [26]
    (193)  |11111111|11111111|11111000|01           3ffffe1  [26]
    (194)  |11111111|11111110|1011                    fffeb  [20]
    (195)  |11111111|11111110|001                     7fff1  [19]
    (196)  |11111111|11111111|100111                 3fffe7  [22]
    (197)  |11111111|11111111|1110010                7ffff2  [23]
    (198)  |11111111|11111111|101000                 3fffe8  [22]
    (199)  |11111111|11111111|11110110|0            1ffffec  [25]
    (200)  |11111111|11111111|11111000|10           3ffffe2  [26]
    (201)  |11111111|11111111|11111000|11           3ffffe3  [26]
    (202)  |11111111|11111111|11111001|00           3ffffe4  [26]
    (203)  |11111111|11111111|11111011|110          7ffffde  [27]
    (204)  |11111111|11111111|11111011|111          7ffffdf  [27]
    (205)  |11111111|11111111|11111001|01           3ffffe5  [26]
    (206)  |11111111|11111111|11110001               fffff1  [24]
    (207)  |11111111|11111111|11110110|1            1ffffed  [25]
    (208)  |11111111|11111110|010                     7fff2  [19]
    (209)  |11111111|11111111|00011                  1fffe3  [21]
    (210)  |11111111|11111111|11111001|10           3ffffe6  [26]
    (211)  |11111111|11111111|11111100|000          7ffffe0  [27]
    (212)  |11111111|11111111|11111100|001          7ffffe1  [27]
    (213)  |11111111|11111111|11111001|11           3ffffe7  [26]
    (214)  |11111111|11111111|11111100|010          7ffffe2  [27]
    (215)  |11111111|11111111|11110010               fffff2  [24]
    (216)  |11111111|11111111|00100                  1fffe4  [21]
    (217)  |11111111|11111111|00101                  1fffe5  [21]
    (218)  |11111111|11111111|11111010|00           3ffffe8  [26]
    (219)  |11111111|11111111|11111010|01           3ffffe9  [26]
    (220)  |11111111|11111111|11111111|1101         ffffffd  [28]
    (221)  |11111111|11111111|11111100|011          7ffffe3  [27]
    (222)  |11111111|11111111|11111100|100          7ffffe4  [27]
    (223)  |11111111|11111111|11111100|101          7ffffe5  [27]
    (224)  |11111111|11111110|1100                    fffec  [20]
    (225)  |11111111|11111111|11110011               fffff3  [24]
    (226)  |11111111|11111110|1101                    fffed  [20]
    (227)  |11111111|11111111|00110                  1fffe6  [21]
    (228)  |11111111|11111111|101001                 3fffe9  [22]
    (229)  |11111111|11111111|00111                  1fffe7  [21]
    (230)  |11111111|11111111|01000                  1fffe8  [21]
    (231)  |11111111|11111111|1110011                7ffff3  [23]
    (232)  |11111111|11111111|101010                 3fffea  [22]
    (233)  |11111111|11111111|101011                 3fffeb  [22]
    (234)  |11111111|11111111|11110111|0            1ffffee  [25]
    (235)  |11111111|11111111|11110111|1            1ffffef  [25]
    (236)  |11111111|11111111|11110100               fffff4  [24]
    (237)  |11111111|11111111|11110101               fffff5  [24]
    (238)  |11111111|11111111|11111010|10           3ffffea  [26]
    (239)  |11111111|11111111|1110100                7ffff4  [23]
    (240)  |11111111|11111111|11111010|11           3ffffeb  [26]
    (241)  |11111111|11111111|11111100|110          7ffffe6  [27]
    (242)  |11111111|11111111|11111011|00           3ffffec  [26]
    (243)  |11111111|11111111|11111011|01           3ffffed  [26]
    (244)  |11111111|11111111|11111100|111          7ffffe7  [27]
    (245)  |11111111|11111111|11111101|000          7ffffe8  [27]
    (246)  |11111111|11111111|11111101|001          7ffffe9  [27]
    (247)  |11111111|11111111|11111101|010          7ffffea  [27]
    (248)  |11111111|11111111|11111101|011          7ffffeb  [27]
    (249)  |11111111|11111111|11111111|1110         ffffffe  [28]
    (250)  |11111111|11111111|11111101|100          7ffffec  [27]
    (251)  |11111111|11111111|11111101|101          7ffffed  [27]
    (252)  |11111111|11111111|11111101|110          7ffffee  [27]
    (253)  |11111111|11111111|11111101|111          7ffffef  [27]
    (254)  |11111111|11111111|11111110|000          7fffff0  [27]
    (255)  |11111111|11111111|11111011|10           3ffffee  [26]
EOS (256)  |11111111|11111111|11111111|111111      3fffffff  [30]
</pre></div></div><div id="examples"><h1 id="rfc.section.C"><a href="#rfc.section.C">C.</a> <a href="#examples">例</a></h1><div id="rfc.section.C.p.1"><p>リクエストとレスポンス両方の、ハフマン符号化を伴う場合と 伴わない場合の、整数、ヘッダフィールド表現そしてヘッダ フィールドのリストのすべてのエンコーディングを含む 数多くの例があります。</p></div><div id="integer.representation.examples"><h2 id="rfc.section.C.1"><a href="#rfc.section.C.1">C.1</a> <a href="#integer.representation.examples">整数表現の例</a></h2><div id="rfc.section.C.1.p.1"><p>この節では (<a href="#integer.representation" title="整数表現">Section 5.1</a> を 参照) に詳細がある整数値の表現の例を記述します。</p></div><div id="integer.representation.example1"><h3 id="rfc.section.C.1.1"><a href="#rfc.section.C.1.1">C.1.1</a> <a href="#integer.representation.example1">例 1: 5 ビットプレフィックスを用いた 10 のエンコーディング</a></h3><div id="rfc.section.C.1.1.p.1"><p>値 10 は 5 ビットプレフィックスでエンコードされます。 </p><ul><li>10 は 31 (2^5 - 1) より小さいので 5 ビットプレフィックスを用いて表現されます。</li></ul></div><div id="rfc.figure.u.4"><pre>
  0   1   2   3   4   5   6   7
+---+---+---+---+---+---+---+---+
| X | X | X | 0 | 1 | 0 | 1 | 0 |   10 stored on 5 bits
+---+---+---+---+---+---+---+---+
</pre></div></div><div id="integer.representation.example2"><h3 id="rfc.section.C.1.2"><a href="#rfc.section.C.1.2">C.1.2</a> <a href="#integer.representation.example2">例 2: 5 ビットプレフィックスを用いた 1337 のエンコーディング</a></h3><div id="rfc.section.C.1.2.p.1"><p>値 I=1337 は 5 ビットプレフィックスでエンコードされます。 </p><ul class="empty"><li>1337 は 31 (2^5 - 1) より大きい。</li><li><ul class="empty"><li>5 ビットプレフィックスは 最大値(31) で 満たされます。</li></ul> </li><li>I = 1337 - (2^5 - 1) = 1306.</li><li><ul class="empty"><li>I (1306) は 128 以上で、 while ループ本体が実行します:</li><li><ul class="empty"><li>I % 128 == 26</li><li>26 + 128 == 154</li><li>154 は 8 ビットでエンコードされます: 10011010</li><li>I に 10 がセットされます (1306 / 128 == 10)</li><li>I は 128 より大きくなく、 while ループは終了します。</li></ul> </li><li>10 になった I は 8 ビットでエンコードされます: 00001010.</li></ul> </li><li>処理終了。</li></ul></div><div id="rfc.figure.u.5"><pre>
  0   1   2   3   4   5   6   7
+---+---+---+---+---+---+---+---+
| X | X | X | 1 | 1 | 1 | 1 | 1 |  Prefix = 31, I = 1306
| 1 | 0 | 0 | 1 | 1 | 0 | 1 | 0 |  1306&gt;=128, encode(154), I=1306/128
| 0 | 0 | 0 | 0 | 1 | 0 | 1 | 0 |  10&lt;128, encode(10), done
+---+---+---+---+---+---+---+---+
</pre></div></div><div id="integer.representation.example3"><h3 id="rfc.section.C.1.3"><a href="#rfc.section.C.1.3">C.1.3</a> <a href="#integer.representation.example3">例 3: オクテット境界で開始する 42 のエンコーディング</a></h3><div id="rfc.section.C.1.3.p.1"><p>値 42 はオクテット境界から開始しエンコードされます。 これは 8 ビットプレフィックスが使用されることを示します。 </p><ul><li>42 は 255 (2^8 - 1) 以下であり 8 ビットプレフィックスを用いて表現されます。</li></ul></div><div id="rfc.figure.u.6"><pre>
  0   1   2   3   4   5   6   7
+---+---+---+---+---+---+---+---+
| 0 | 0 | 1 | 0 | 1 | 0 | 1 | 0 |   42 stored on 8 bits
+---+---+---+---+---+---+---+---+
</pre></div></div></div><div id="header.field.representation.examples"><h2 id="rfc.section.C.2"><a href="#rfc.section.C.2">C.2</a> <a href="#header.field.representation.examples">ヘッダフィールド表現の例</a></h2><div id="rfc.section.C.2.p.1"><p>この節では幾つかの個々の表現の例を掲載します。</p></div><div><h3 id="rfc.section.C.2.1"><a href="#rfc.section.C.2.1">C.2.1</a> インデックスを伴うリテラルヘッダフィールド</h3><div id="rfc.section.C.2.1.p.1"><p>ヘッダフィールド表現はリテラル名とリテラル値を使用します。 ヘッダフィールドは動的テーブルに追加されます。</p></div><div id="rfc.section.C.2.1.p.2"><span id="rfc.figure.u.7"><p>エンコードするヘッダリスト:</p><pre>
custom-key: custom-header</pre></span></div><div id="rfc.section.C.2.1.p.3"><span id="rfc.figure.u.8"><p>エンコードされたデータの 16 進数ダンプ:</p><pre>
400a 6375 7374 6f6d 2d6b 6579 0d63 7573 | @.custom-key.cus
746f 6d2d 6865 6164 6572                | tom-header</pre></span></div><div id="rfc.section.C.2.1.p.4"><span id="rfc.figure.u.9"><p>デコード処理:</p><pre>
40                                      | == Literal indexed ==
0a                                      |   Literal name (len = 10)
6375 7374 6f6d 2d6b 6579                | custom-key
0d                                      |   Literal value (len = 13)
6375 7374 6f6d 2d68 6561 6465 72        | custom-header
                                        | -&gt; custom-key: custom-head\
                                        |   er</pre></span></div><div id="rfc.section.C.2.1.p.5"><span id="rfc.figure.u.10"><p>動的テーブル (デコード後):</p><pre>
[  1] (s =  55) custom-key: custom-header
      Table size:  55</pre></span></div><div id="rfc.section.C.2.1.p.6"><span id="rfc.figure.u.11"><p>デコードされたヘッダリスト:</p><pre>
custom-key: custom-header</pre></span></div></div><div><h3 id="rfc.section.C.2.2"><a href="#rfc.section.C.2.2">C.2.2</a> インデックスを伴わないリテラルヘッダフィールド</h3><div id="rfc.section.C.2.2.p.1"><p>ヘッダフィールド表現はリテラル名とリテラル値を使用します。 ヘッダフィールドは動的テーブルに追加されません。</p></div><div id="rfc.section.C.2.2.p.2"><span id="rfc.figure.u.12"><p>エンコードするヘッダリスト:</p><pre>
:path: /sample/path</pre></span></div><div id="rfc.section.C.2.2.p.3"><span id="rfc.figure.u.13"><p>エンコードされたデータの 16 進数ダンプ:</p><pre>
040c 2f73 616d 706c 652f 7061 7468      | ../sample/path</pre></span></div><div id="rfc.section.C.2.2.p.4"><span id="rfc.figure.u.14"><p>デコード処理:</p><pre>
04                                      | == Literal not indexed ==
                                        |   Indexed name (idx = 4)
                                        |     :path
0c                                      |   Literal value (len = 12)
2f73 616d 706c 652f 7061 7468           | /sample/path
                                        | -&gt; :path: /sample/path</pre></span></div><div id="rfc.section.C.2.2.p.5"><p>動的テーブル (デコード後): 空</p></div><div id="rfc.section.C.2.2.p.6"><span id="rfc.figure.u.15"><p>デコードされたヘッダリスト:</p><pre>
:path: /sample/path</pre></span></div></div><div><h3 id="rfc.section.C.2.3"><a href="#rfc.section.C.2.3">C.2.3</a> インデックスされないリテラルヘッダフィールド</h3><div id="rfc.section.C.2.3.p.1"><p>ヘッダフィールド表現はリテラル名とリテラル値を使用します。 ヘッダフィールドは動的テーブルに追加されず、中継者に 再エンコードされる場合同じ表現を使わなければなりません。</p></div><div id="rfc.section.C.2.3.p.2"><span id="rfc.figure.u.16"><p>エンコードするヘッダリスト:</p><pre>
password: secret</pre></span></div><div id="rfc.section.C.2.3.p.3"><span id="rfc.figure.u.17"><p>エンコードされたデータの 16 進数ダンプ:</p><pre>
1008 7061 7373 776f 7264 0673 6563 7265 | ..password.secre
74                                      | t</pre></span></div><div id="rfc.section.C.2.3.p.4"><span id="rfc.figure.u.18"><p>デコード処理:</p><pre>
10                                      | == Literal never indexed ==
08                                      |   Literal name (len = 8)
7061 7373 776f 7264                     | password
06                                      |   Literal value (len = 6)
7365 6372 6574                          | secret
                                        | -&gt; password: secret</pre></span></div><div id="rfc.section.C.2.3.p.5"><p>動的テーブル (デコード後): 空</p></div><div id="rfc.section.C.2.3.p.6"><span id="rfc.figure.u.19"><p>デコードされたヘッダリスト:</p><pre>
password: secret</pre></span></div></div><div><h3 id="rfc.section.C.2.4"><a href="#rfc.section.C.2.4">C.2.4</a> インデックスヘッダフィールド</h3><div id="rfc.section.C.2.4.p.1"><p>このヘッダフィールド表現は静的テーブルにインデックスされたヘッダ フィールドを使用します。</p></div><div id="rfc.section.C.2.4.p.2"><span id="rfc.figure.u.20"><p>エンコードするヘッダリスト:</p><pre>
:method: GET</pre></span></div><div id="rfc.section.C.2.4.p.3"><span id="rfc.figure.u.21"><p>エンコードされたデータの 16 進ダンプ:</p><pre>
82                                      | .</pre></span></div><div id="rfc.section.C.2.4.p.4"><span id="rfc.figure.u.22"><p>デコード処理:</p><pre>
82                                      | == Indexed - Add ==
                                        |   idx = 2
                                        | -&gt; :method: GET</pre></span></div><div id="rfc.section.C.2.4.p.5"><p>動的テーブル (デコード後): 空</p></div><div id="rfc.section.C.2.4.p.6"><span id="rfc.figure.u.23"><p>デコードされたヘッダリスト:</p><pre>
:method: GET</pre></span></div></div></div><div id="request.examples.without.huffman.coding"><h2 id="rfc.section.C.3"><a href="#rfc.section.C.3">C.3</a> <a href="#request.examples.without.huffman.coding">ハフマン符号化を伴わないリクエストの例</a></h2><div id="rfc.section.C.3.p.1"><p>この節は同じコネクションにおける HTTP リクエストに対応した 幾つかの連続したヘッダリストを示します。</p></div><div><h3 id="rfc.section.C.3.1"><a href="#rfc.section.C.3.1">C.3.1</a> 一個目のリクエスト</h3><div id="rfc.section.C.3.1.p.1"><span id="rfc.figure.u.24"><p>エンコードするヘッダリスト:</p><pre>
:method: GET
:scheme: http
:path: /
:authority: www.example.com</pre></span></div><div id="rfc.section.C.3.1.p.2"><span id="rfc.figure.u.25"><p>エンコードされたデータの 16 進数ダンプ:</p><pre>
8286 8441 0f77 7777 2e65 7861 6d70 6c65 | ...A.www.example
2e63 6f6d                               | .com</pre></span></div><div id="rfc.section.C.3.1.p.3"><span id="rfc.figure.u.26"><p>デコード処理:</p><pre>
82                                      | == Indexed - Add ==
                                        |   idx = 2
                                        | -&gt; :method: GET
86                                      | == Indexed - Add ==
                                        |   idx = 6
                                        | -&gt; :scheme: http
84                                      | == Indexed - Add ==
                                        |   idx = 4
                                        | -&gt; :path: /
41                                      | == Literal indexed ==
                                        |   Indexed name (idx = 1)
                                        |     :authority
0f                                      |   Literal value (len = 15)
7777 772e 6578 616d 706c 652e 636f 6d   | www.example.com
                                        | -&gt; :authority: www.example\
                                        |   .com</pre></span></div><div id="rfc.section.C.3.1.p.4"><span id="rfc.figure.u.27"><p>動的テーブル (デコード後):</p><pre>
[  1] (s =  57) :authority: www.example.com
      Table size:  57</pre></span></div><div id="rfc.section.C.3.1.p.5"><span id="rfc.figure.u.28"><p>デコードされたヘッダリスト:</p><pre>
:method: GET
:scheme: http
:path: /
:authority: www.example.com</pre></span></div></div><div><h3 id="rfc.section.C.3.2"><a href="#rfc.section.C.3.2">C.3.2</a> 二個目のリクエスト</h3><div id="rfc.section.C.3.2.p.1"><span id="rfc.figure.u.29"><p>エンコードするヘッダリスト:</p><pre>
:method: GET
:scheme: http
:path: /
:authority: www.example.com
cache-control: no-cache</pre></span></div><div id="rfc.section.C.3.2.p.2"><span id="rfc.figure.u.30"><p>エンコードされたデータの 16 進数ダンプ:</p><pre>
8286 84be 5808 6e6f 2d63 6163 6865      | ....X.no-cache</pre></span></div><div id="rfc.section.C.3.2.p.3"><span id="rfc.figure.u.31"><p>デコード処理:</p><pre>
82                                      | == Indexed - Add ==
                                        |   idx = 2
                                        | -&gt; :method: GET
86                                      | == Indexed - Add ==
                                        |   idx = 6
                                        | -&gt; :scheme: http
84                                      | == Indexed - Add ==
                                        |   idx = 4
                                        | -&gt; :path: /
be                                      | == Indexed - Add ==
                                        |   idx = 62
                                        | -&gt; :authority: www.example\
                                        |   .com
58                                      | == Literal indexed ==
                                        |   Indexed name (idx = 24)
                                        |     cache-control
08                                      |   Literal value (len = 8)
6e6f 2d63 6163 6865                     | no-cache
                                        | -&gt; cache-control: no-cache</pre></span></div><div id="rfc.section.C.3.2.p.4"><span id="rfc.figure.u.32"><p>動的テーブル (デコード後):</p><pre>
[  1] (s =  53) cache-control: no-cache
[  2] (s =  57) :authority: www.example.com
      Table size: 110</pre></span></div><div id="rfc.section.C.3.2.p.5"><span id="rfc.figure.u.33"><p>デコードされたヘッダリスト:</p><pre>
:method: GET
:scheme: http
:path: /
:authority: www.example.com
cache-control: no-cache</pre></span></div></div><div><h3 id="rfc.section.C.3.3"><a href="#rfc.section.C.3.3">C.3.3</a> 三個目のリクエスト</h3><div id="rfc.section.C.3.3.p.1"><span id="rfc.figure.u.34"><p>エンコードするヘッダリスト:</p><pre>
:method: GET
:scheme: https
:path: /index.html
:authority: www.example.com
custom-key: custom-value</pre></span></div><div id="rfc.section.C.3.3.p.2"><span id="rfc.figure.u.35"><p>エンコードされたデータの 16 進数ダンプ:</p><pre>
8287 85bf 400a 6375 7374 6f6d 2d6b 6579 | ....@.custom-key
0c63 7573 746f 6d2d 7661 6c75 65        | .custom-value</pre></span></div><div id="rfc.section.C.3.3.p.3"><span id="rfc.figure.u.36"><p>デコード処理:</p><pre>
82                                      | == Indexed - Add ==
                                        |   idx = 2
                                        | -&gt; :method: GET
87                                      | == Indexed - Add ==
                                        |   idx = 7
                                        | -&gt; :scheme: https
85                                      | == Indexed - Add ==
                                        |   idx = 5
                                        | -&gt; :path: /index.html
bf                                      | == Indexed - Add ==
                                        |   idx = 63
                                        | -&gt; :authority: www.example\
                                        |   .com
40                                      | == Literal indexed ==
0a                                      |   Literal name (len = 10)
6375 7374 6f6d 2d6b 6579                | custom-key
0c                                      |   Literal value (len = 12)
6375 7374 6f6d 2d76 616c 7565           | custom-value
                                        | -&gt; custom-key: custom-valu\
                                        |   e</pre></span></div><div id="rfc.section.C.3.3.p.4"><span id="rfc.figure.u.37"><p>動的テーブル (デコード後):</p><pre>
[  1] (s =  54) custom-key: custom-value
[  2] (s =  53) cache-control: no-cache
[  3] (s =  57) :authority: www.example.com
      Table size: 164</pre></span></div><div id="rfc.section.C.3.3.p.5"><span id="rfc.figure.u.38"><p>デコードされたヘッダリスト:</p><pre>
:method: GET
:scheme: https
:path: /index.html
:authority: www.example.com
custom-key: custom-value</pre></span></div></div></div><div id="request.examples.with.huffman.coding"><h2 id="rfc.section.C.4"><a href="#rfc.section.C.4">C.4</a> <a href="#request.examples.with.huffman.coding">ハフマン符号化を伴うリクエストの例</a></h2><div id="rfc.section.C.4.p.1"><p>この節では前節と同じ例を示しますが、リテラル値にハフマン符号化を 行います。</p></div><div><h3 id="rfc.section.C.4.1"><a href="#rfc.section.C.4.1">C.4.1</a> 一個目のリクエスト</h3><div id="rfc.section.C.4.1.p.1"><span id="rfc.figure.u.39"><p>エンコードするヘッダリスト:</p><pre>
:method: GET
:scheme: http
:path: /
:authority: www.example.com</pre></span></div><div id="rfc.section.C.4.1.p.2"><span id="rfc.figure.u.40"><p>エンコードされたデータの 16 進数ダンプ:</p><pre>
8286 8441 8cf1 e3c2 e5f2 3a6b a0ab 90f4 | ...A......:k....
ff                                      | .</pre></span></div><div id="rfc.section.C.4.1.p.3"><span id="rfc.figure.u.41"><p>デコード処理:</p><pre>
82                                      | == Indexed - Add ==
                                        |   idx = 2
                                        | -&gt; :method: GET
86                                      | == Indexed - Add ==
                                        |   idx = 6
                                        | -&gt; :scheme: http
84                                      | == Indexed - Add ==
                                        |   idx = 4
                                        | -&gt; :path: /
41                                      | == Literal indexed ==
                                        |   Indexed name (idx = 1)
                                        |     :authority
8c                                      |   Literal value (len = 12)
                                        |     Huffman encoded:
f1e3 c2e5 f23a 6ba0 ab90 f4ff           | .....:k.....
                                        |     Decoded:
                                        | www.example.com
                                        | -&gt; :authority: www.example\
                                        |   .com</pre></span></div><div id="rfc.section.C.4.1.p.4"><span id="rfc.figure.u.42"><p>動的テーブル (デコード後):</p><pre>
[  1] (s =  57) :authority: www.example.com
      Table size:  57</pre></span></div><div id="rfc.section.C.4.1.p.5"><span id="rfc.figure.u.43"><p>デコードされたヘッダリスト:</p><pre>
:method: GET
:scheme: http
:path: /
:authority: www.example.com</pre></span></div></div><div><h3 id="rfc.section.C.4.2"><a href="#rfc.section.C.4.2">C.4.2</a> 二個目のリクエスト</h3><div id="rfc.section.C.4.2.p.1"><span id="rfc.figure.u.44"><p>エンコードするヘッダリスト:</p><pre>
:method: GET
:scheme: http
:path: /
:authority: www.example.com
cache-control: no-cache</pre></span></div><div id="rfc.section.C.4.2.p.2"><span id="rfc.figure.u.45"><p>エンコードされたデータの 16 進数ダンプ:</p><pre>
8286 84be 5886 a8eb 1064 9cbf           | ....X....d..</pre></span></div><div id="rfc.section.C.4.2.p.3"><span id="rfc.figure.u.46"><p>デコード処理:</p><pre>
82                                      | == Indexed - Add ==
                                        |   idx = 2
                                        | -&gt; :method: GET
86                                      | == Indexed - Add ==
                                        |   idx = 6
                                        | -&gt; :scheme: http
84                                      | == Indexed - Add ==
                                        |   idx = 4
                                        | -&gt; :path: /
be                                      | == Indexed - Add ==
                                        |   idx = 62
                                        | -&gt; :authority: www.example\
                                        |   .com
58                                      | == Literal indexed ==
                                        |   Indexed name (idx = 24)
                                        |     cache-control
86                                      |   Literal value (len = 6)
                                        |     Huffman encoded:
a8eb 1064 9cbf                          | ...d..
                                        |     Decoded:
                                        | no-cache
                                        | -&gt; cache-control: no-cache</pre></span></div><div id="rfc.section.C.4.2.p.4"><span id="rfc.figure.u.47"><p>動的テーブル (デコード後):</p><pre>
[  1] (s =  53) cache-control: no-cache
[  2] (s =  57) :authority: www.example.com
      Table size: 110</pre></span></div><div id="rfc.section.C.4.2.p.5"><span id="rfc.figure.u.48"><p>デコードされたヘッダリスト:</p><pre>
:method: GET
:scheme: http
:path: /
:authority: www.example.com
cache-control: no-cache</pre></span></div></div><div><h3 id="rfc.section.C.4.3"><a href="#rfc.section.C.4.3">C.4.3</a> 三個目のリクエスト</h3><div id="rfc.section.C.4.3.p.1"><span id="rfc.figure.u.49"><p>エンコードするヘッダリスト:</p><pre>
:method: GET
:scheme: https
:path: /index.html
:authority: www.example.com
custom-key: custom-value</pre></span></div><div id="rfc.section.C.4.3.p.2"><span id="rfc.figure.u.50"><p>エンコードされたデータの 16 進数ダンプ:</p><pre>
8287 85bf 4088 25a8 49e9 5ba9 7d7f 8925 | ....@.%.I.[.}..%
a849 e95b b8e8 b4bf                     | .I.[....</pre></span></div><div id="rfc.section.C.4.3.p.3"><span id="rfc.figure.u.51"><p>デコード処理:</p><pre>
82                                      | == Indexed - Add ==
                                        |   idx = 2
                                        | -&gt; :method: GET
87                                      | == Indexed - Add ==
                                        |   idx = 7
                                        | -&gt; :scheme: https
85                                      | == Indexed - Add ==
                                        |   idx = 5
                                        | -&gt; :path: /index.html
bf                                      | == Indexed - Add ==
                                        |   idx = 63
                                        | -&gt; :authority: www.example\
                                        |   .com
40                                      | == Literal indexed ==
88                                      |   Literal name (len = 8)
                                        |     Huffman encoded:
25a8 49e9 5ba9 7d7f                     | %.I.[.}.
                                        |     Decoded:
                                        | custom-key
89                                      |   Literal value (len = 9)
                                        |     Huffman encoded:
25a8 49e9 5bb8 e8b4 bf                  | %.I.[....
                                        |     Decoded:
                                        | custom-value
                                        | -&gt; custom-key: custom-valu\
                                        |   e</pre></span></div><div id="rfc.section.C.4.3.p.4"><span id="rfc.figure.u.52"><p>動的テーブル (デコード後):</p><pre>
[  1] (s =  54) custom-key: custom-value
[  2] (s =  53) cache-control: no-cache
[  3] (s =  57) :authority: www.example.com
      Table size: 164</pre></span></div><div id="rfc.section.C.4.3.p.5"><span id="rfc.figure.u.53"><p>デコードされたヘッダリスト:</p><pre>
:method: GET
:scheme: https
:path: /index.html
:authority: www.example.com
custom-key: custom-value</pre></span></div></div></div><div id="response.examples.without.huffman.coding"><h2 id="rfc.section.C.5"><a href="#rfc.section.C.5">C.5</a> <a href="#response.examples.without.huffman.coding">ハフマン符号化を伴わないレスポンスの例</a></h2><div id="rfc.section.C.5.p.1"><p>この節は同じコネクションにおける HTTP レスポンスに対応した 幾つかの連続したヘッダリストを示します。 HTTP/2 設定パラメータ SETTINGS_HEADER_TABLE_SIZE は幾つかの削除を起こすため、 256 オクテットの値で設定されています。</p></div><div><h3 id="rfc.section.C.5.1"><a href="#rfc.section.C.5.1">C.5.1</a> 一個目のレスポンス</h3><div id="rfc.section.C.5.1.p.1"><span id="rfc.figure.u.54"><p>エンコードするヘッダリスト:</p><pre>
:status: 302
cache-control: private
date: Mon, 21 Oct 2013 20:13:21 GMT
location: https://www.example.com</pre></span></div><div id="rfc.section.C.5.1.p.2"><span id="rfc.figure.u.55"><p>エンコードされたデータの 16 進数ダンプ:</p><pre>
4803 3330 3258 0770 7269 7661 7465 611d | H.302X.privatea.
4d6f 6e2c 2032 3120 4f63 7420 3230 3133 | Mon, 21 Oct 2013
2032 303a 3133 3a32 3120 474d 546e 1768 |  20:13:21 GMTn.h
7474 7073 3a2f 2f77 7777 2e65 7861 6d70 | ttps://www.examp
6c65 2e63 6f6d                          | le.com</pre></span></div><div id="rfc.section.C.5.1.p.3"><span id="rfc.figure.u.56"><p>デコード処理:</p><pre>
48                                      | == Literal indexed ==
                                        |   Indexed name (idx = 8)
                                        |     :status
03                                      |   Literal value (len = 3)
3330 32                                 | 302
                                        | -&gt; :status: 302
58                                      | == Literal indexed ==
                                        |   Indexed name (idx = 24)
                                        |     cache-control
07                                      |   Literal value (len = 7)
7072 6976 6174 65                       | private
                                        | -&gt; cache-control: private
61                                      | == Literal indexed ==
                                        |   Indexed name (idx = 33)
                                        |     date
1d                                      |   Literal value (len = 29)
4d6f 6e2c 2032 3120 4f63 7420 3230 3133 | Mon, 21 Oct 2013
2032 303a 3133 3a32 3120 474d 54        |  20:13:21 GMT
                                        | -&gt; date: Mon, 21 Oct 2013 \
                                        |   20:13:21 GMT
6e                                      | == Literal indexed ==
                                        |   Indexed name (idx = 46)
                                        |     location
17                                      |   Literal value (len = 23)
6874 7470 733a 2f2f 7777 772e 6578 616d | https://www.exam
706c 652e 636f 6d                       | ple.com
                                        | -&gt; location: https://www.e\
                                        |   xample.com</pre></span></div><div id="rfc.section.C.5.1.p.4"><span id="rfc.figure.u.57"><p>動的テーブル (デコード後):</p><pre>
[  1] (s =  63) location: https://www.example.com
[  2] (s =  65) date: Mon, 21 Oct 2013 20:13:21 GMT
[  3] (s =  52) cache-control: private
[  4] (s =  42) :status: 302
      Table size: 222</pre></span></div><div id="rfc.section.C.5.1.p.5"><span id="rfc.figure.u.58"><p>デコードされたヘッダリスト:</p><pre>
:status: 302
cache-control: private
date: Mon, 21 Oct 2013 20:13:21 GMT
location: https://www.example.com</pre></span></div></div><div><h3 id="rfc.section.C.5.2"><a href="#rfc.section.C.5.2">C.5.2</a> 二個目のレスポンス</h3><div id="rfc.section.C.5.2.p.1"><p>(":status", "307") ヘッダフィールドの追加を行える領域を解放するため (":status", "302") ヘッダフィールドは動的テーブルから削除されます。</p></div><div id="rfc.section.C.5.2.p.2"><span id="rfc.figure.u.59"><p>エンコードするヘッダリスト:</p><pre>
:status: 307
cache-control: private
date: Mon, 21 Oct 2013 20:13:21 GMT
location: https://www.example.com</pre></span></div><div id="rfc.section.C.5.2.p.3"><span id="rfc.figure.u.60"><p>エンコードされたデータの 16 進数ダンプ:</p><pre>
4803 3330 37c1 c0bf                     | H.307...</pre></span></div><div id="rfc.section.C.5.2.p.4"><span id="rfc.figure.u.61"><p>デコード処理:</p><pre>
48                                      | == Literal indexed ==
                                        |   Indexed name (idx = 8)
                                        |     :status
03                                      |   Literal value (len = 3)
3330 37                                 | 307
                                        | - evict: :status: 302
                                        | -&gt; :status: 307
c1                                      | == Indexed - Add ==
                                        |   idx = 65
                                        | -&gt; cache-control: private
c0                                      | == Indexed - Add ==
                                        |   idx = 64
                                        | -&gt; date: Mon, 21 Oct 2013 \
                                        |   20:13:21 GMT
bf                                      | == Indexed - Add ==
                                        |   idx = 63
                                        | -&gt; location: https://www.e\
                                        |   xample.com</pre></span></div><div id="rfc.section.C.5.2.p.5"><span id="rfc.figure.u.62"><p>動的テーブル (デコード後):</p><pre>
[  1] (s =  42) :status: 307
[  2] (s =  63) location: https://www.example.com
[  3] (s =  65) date: Mon, 21 Oct 2013 20:13:21 GMT
[  4] (s =  52) cache-control: private
      Table size: 222</pre></span></div><div id="rfc.section.C.5.2.p.6"><span id="rfc.figure.u.63"><p>デコードされたヘッダリスト:</p><pre>
:status: 307
cache-control: private
date: Mon, 21 Oct 2013 20:13:21 GMT
location: https://www.example.com</pre></span></div></div><div><h3 id="rfc.section.C.5.3"><a href="#rfc.section.C.5.3">C.5.3</a> 三個目のレスポンス</h3><div id="rfc.section.C.5.3.p.1"><p>このヘッダリストの処理中幾つかのヘッダフィールドが動的テーブルから 削除されます。</p></div><div id="rfc.section.C.5.3.p.2"><span id="rfc.figure.u.64"><p>エンコードするヘッダリスト:</p><pre>
:status: 200
cache-control: private
date: Mon, 21 Oct 2013 20:13:22 GMT
location: https://www.example.com
content-encoding: gzip
set-cookie: foo=ASDJKHQKBZXOQWEOPIUAXQWEOIU; max-age=3600; version=1</pre></span></div><div id="rfc.section.C.5.3.p.3"><span id="rfc.figure.u.65"><p>エンコードされたデータの 16 進数ダンプ:</p><pre>
88c1 611d 4d6f 6e2c 2032 3120 4f63 7420 | ..a.Mon, 21 Oct
3230 3133 2032 303a 3133 3a32 3220 474d | 2013 20:13:22 GM
54c0 5a04 677a 6970 7738 666f 6f3d 4153 | T.Z.gzipw8foo=AS
444a 4b48 514b 425a 584f 5157 454f 5049 | DJKHQKBZXOQWEOPI
5541 5851 5745 4f49 553b 206d 6178 2d61 | UAXQWEOIU; max-a
6765 3d33 3630 303b 2076 6572 7369 6f6e | ge=3600; version
3d31                                    | =1</pre></span></div><div id="rfc.section.C.5.3.p.4"><span id="rfc.figure.u.66"><p>デコード処理:</p><pre>
88                                      | == Indexed - Add ==
                                        |   idx = 8
                                        | -&gt; :status: 200
c1                                      | == Indexed - Add ==
                                        |   idx = 65
                                        | -&gt; cache-control: private
61                                      | == Literal indexed ==
                                        |   Indexed name (idx = 33)
                                        |     date
1d                                      |   Literal value (len = 29)
4d6f 6e2c 2032 3120 4f63 7420 3230 3133 | Mon, 21 Oct 2013
2032 303a 3133 3a32 3220 474d 54        |  20:13:22 GMT
                                        | - evict: cache-control: pr\
                                        |   ivate
                                        | -&gt; date: Mon, 21 Oct 2013 \
                                        |   20:13:22 GMT
c0                                      | == Indexed - Add ==
                                        |   idx = 64
                                        | -&gt; location: https://www.e\
                                        |   xample.com
5a                                      | == Literal indexed ==
                                        |   Indexed name (idx = 26)
                                        |     content-encoding
04                                      |   Literal value (len = 4)
677a 6970                               | gzip
                                        | - evict: date: Mon, 21 Oct\
                                        |    2013 20:13:21 GMT
                                        | -&gt; content-encoding: gzip
77                                      | == Literal indexed ==
                                        |   Indexed name (idx = 55)
                                        |     set-cookie
38                                      |   Literal value (len = 56)
666f 6f3d 4153 444a 4b48 514b 425a 584f | foo=ASDJKHQKBZXO
5157 454f 5049 5541 5851 5745 4f49 553b | QWEOPIUAXQWEOIU;
206d 6178 2d61 6765 3d33 3630 303b 2076 |  max-age=3600; v
6572 7369 6f6e 3d31                     | ersion=1
                                        | - evict: location: https:/\
                                        |   /www.example.com
                                        | - evict: :status: 307
                                        | -&gt; set-cookie: foo=ASDJKHQ\
                                        |   KBZXOQWEOPIUAXQWEOIU; ma\
                                        |   x-age=3600; version=1</pre></span></div><div id="rfc.section.C.5.3.p.5"><span id="rfc.figure.u.67"><p>動的テーブル (デコード後):</p><pre>
[  1] (s =  98) set-cookie: foo=ASDJKHQKBZXOQWEOPIUAXQWEOIU; max-age\
                 =3600; version=1
[  2] (s =  52) content-encoding: gzip
[  3] (s =  65) date: Mon, 21 Oct 2013 20:13:22 GMT
      Table size: 215</pre></span></div><div id="rfc.section.C.5.3.p.6"><span id="rfc.figure.u.68"><p>デコードされたヘッダリスト:</p><pre>
:status: 200
cache-control: private
date: Mon, 21 Oct 2013 20:13:22 GMT
location: https://www.example.com
content-encoding: gzip
set-cookie: foo=ASDJKHQKBZXOQWEOPIUAXQWEOIU; max-age=3600; version=1</pre></span></div></div></div><div id="response.examples.with.huffman.coding"><h2 id="rfc.section.C.6"><a href="#rfc.section.C.6">C.6</a> <a href="#response.examples.with.huffman.coding">ハフマン符号化を伴うレスポンスの例</a></h2><div id="rfc.section.C.6.p.1"><p>この節は同じコネクションにおける HTTP レスポンスに対応した 幾つかの連続したヘッダリストを示します。 HTTP/2 設定パラメータ SETTINGS_HEADER_TABLE_SIZE は幾つかの削除を起こすため、 256 オクテットの値で設定されています。削除メカニズムはデコードされた リテラル値の長さを使用するため、前節と同じ削除処理が起こります。</p></div><div><h3 id="rfc.section.C.6.1"><a href="#rfc.section.C.6.1">C.6.1</a> 一個目のレスポンス</h3><div id="rfc.section.C.6.1.p.1"><span id="rfc.figure.u.69"><p>エンコードするヘッダリスト:</p><pre>
:status: 302
cache-control: private
date: Mon, 21 Oct 2013 20:13:21 GMT
location: https://www.example.com</pre></span></div><div id="rfc.section.C.6.1.p.2"><span id="rfc.figure.u.70"><p>エンコードされたデータの 16 進数ダンプ:</p><pre>
4882 6402 5885 aec3 771a 4b61 96d0 7abe | H.d.X...w.Ka..z.
9410 54d4 44a8 2005 9504 0b81 66e0 82a6 | ..T.D. .....f...
2d1b ff6e 919d 29ad 1718 63c7 8f0b 97c8 | -..n..)...c.....
e9ae 82ae 43d3                          | ....C.</pre></span></div><div id="rfc.section.C.6.1.p.3"><span id="rfc.figure.u.71"><p>デコード処理:</p><pre>
48                                      | == Literal indexed ==
                                        |   Indexed name (idx = 8)
                                        |     :status
82                                      |   Literal value (len = 2)
                                        |     Huffman encoded:
6402                                    | d.
                                        |     Decoded:
                                        | 302
                                        | -&gt; :status: 302
58                                      | == Literal indexed ==
                                        |   Indexed name (idx = 24)
                                        |     cache-control
85                                      |   Literal value (len = 5)
                                        |     Huffman encoded:
aec3 771a 4b                            | ..w.K
                                        |     Decoded:
                                        | private
                                        | -&gt; cache-control: private
61                                      | == Literal indexed ==
                                        |   Indexed name (idx = 33)
                                        |     date
96                                      |   Literal value (len = 22)
                                        |     Huffman encoded:
d07a be94 1054 d444 a820 0595 040b 8166 | .z...T.D. .....f
e082 a62d 1bff                          | ...-..
                                        |     Decoded:
                                        | Mon, 21 Oct 2013 20:13:21 \
                                        | GMT
                                        | -&gt; date: Mon, 21 Oct 2013 \
                                        |   20:13:21 GMT
6e                                      | == Literal indexed ==
                                        |   Indexed name (idx = 46)
                                        |     location
91                                      |   Literal value (len = 17)
                                        |     Huffman encoded:
9d29 ad17 1863 c78f 0b97 c8e9 ae82 ae43 | .)...c.........C
d3                                      | .
                                        |     Decoded:
                                        | https://www.example.com
                                        | -&gt; location: https://www.e\
                                        |   xample.com</pre></span></div><div id="rfc.section.C.6.1.p.4"><span id="rfc.figure.u.72"><p>動的テーブル (デコード後):</p><pre>
[  1] (s =  63) location: https://www.example.com
[  2] (s =  65) date: Mon, 21 Oct 2013 20:13:21 GMT
[  3] (s =  52) cache-control: private
[  4] (s =  42) :status: 302
      Table size: 222</pre></span></div><div id="rfc.section.C.6.1.p.5"><span id="rfc.figure.u.73"><p>デコードされたヘッダリスト:</p><pre>
:status: 302
cache-control: private
date: Mon, 21 Oct 2013 20:13:21 GMT
location: https://www.example.com</pre></span></div></div><div><h3 id="rfc.section.C.6.2"><a href="#rfc.section.C.6.2">C.6.2</a> 二個目のレスポンス</h3><div id="rfc.section.C.6.2.p.1"><p>(":status", "307") ヘッダフィールドの追加を行える領域を解放するため (":status", "302") ヘッダフィールドは動的テーブルから削除されます。</p></div><div id="rfc.section.C.6.2.p.2"><span id="rfc.figure.u.74"><p>エンコードするヘッダリスト:</p><pre>
:status: 307
cache-control: private
date: Mon, 21 Oct 2013 20:13:21 GMT
location: https://www.example.com</pre></span></div><div id="rfc.section.C.6.2.p.3"><span id="rfc.figure.u.75"><p>エンコードされたデータの 16 進数ダンプ:</p><pre>
4883 640e ffc1 c0bf                     | H.d.....</pre></span></div><div id="rfc.section.C.6.2.p.4"><span id="rfc.figure.u.76"><p>デコード処理:</p><pre>
48                                      | == Literal indexed ==
                                        |   Indexed name (idx = 8)
                                        |     :status
83                                      |   Literal value (len = 3)
                                        |     Huffman encoded:
640e ff                                 | d..
                                        |     Decoded:
                                        | 307
                                        | - evict: :status: 302
                                        | -&gt; :status: 307
c1                                      | == Indexed - Add ==
                                        |   idx = 65
                                        | -&gt; cache-control: private
c0                                      | == Indexed - Add ==
                                        |   idx = 64
                                        | -&gt; date: Mon, 21 Oct 2013 \
                                        |   20:13:21 GMT
bf                                      | == Indexed - Add ==
                                        |   idx = 63
                                        | -&gt; location: https://www.e\
                                        |   xample.com</pre></span></div><div id="rfc.section.C.6.2.p.5"><span id="rfc.figure.u.77"><p>動的テーブル (デコード後):</p><pre>
[  1] (s =  42) :status: 307
[  2] (s =  63) location: https://www.example.com
[  3] (s =  65) date: Mon, 21 Oct 2013 20:13:21 GMT
[  4] (s =  52) cache-control: private
      Table size: 222</pre></span></div><div id="rfc.section.C.6.2.p.6"><span id="rfc.figure.u.78"><p>デコードされたヘッダリスト:</p><pre>
:status: 307
cache-control: private
date: Mon, 21 Oct 2013 20:13:21 GMT
location: https://www.example.com</pre></span></div></div><div><h3 id="rfc.section.C.6.3"><a href="#rfc.section.C.6.3">C.6.3</a> 三個目のレスポンス</h3><div id="rfc.section.C.6.3.p.1"><p>このヘッダリストの処理中幾つかのヘッダフィールドが動的テーブルから 削除されます。</p></div><div id="rfc.section.C.6.3.p.2"><span id="rfc.figure.u.79"><p>エンコードするヘッダリスト:</p><pre>
:status: 200
cache-control: private
date: Mon, 21 Oct 2013 20:13:22 GMT
location: https://www.example.com
content-encoding: gzip
set-cookie: foo=ASDJKHQKBZXOQWEOPIUAXQWEOIU; max-age=3600; version=1</pre></span></div><div id="rfc.section.C.6.3.p.3"><span id="rfc.figure.u.80"><p>エンコードされたデータの 16 進数ダンプ:</p><pre>
88c1 6196 d07a be94 1054 d444 a820 0595 | ..a..z...T.D. ..
040b 8166 e084 a62d 1bff c05a 839b d9ab | ...f...-...Z....
77ad 94e7 821d d7f2 e6c7 b335 dfdf cd5b | w..........5...[
3960 d5af 2708 7f36 72c1 ab27 0fb5 291f | 9`..'..6r..'..).
9587 3160 65c0 03ed 4ee5 b106 3d50 07   | ..1`e...N...=P.</pre></span></div><div id="rfc.section.C.6.3.p.4"><span id="rfc.figure.u.81"><p>デコード処理:</p><pre>
88                                      | == Indexed - Add ==
                                        |   idx = 8
                                        | -&gt; :status: 200
c1                                      | == Indexed - Add ==
                                        |   idx = 65
                                        | -&gt; cache-control: private
61                                      | == Literal indexed ==
                                        |   Indexed name (idx = 33)
                                        |     date
96                                      |   Literal value (len = 22)
                                        |     Huffman encoded:
d07a be94 1054 d444 a820 0595 040b 8166 | .z...T.D. .....f
e084 a62d 1bff                          | ...-..
                                        |     Decoded:
                                        | Mon, 21 Oct 2013 20:13:22 \
                                        | GMT
                                        | - evict: cache-control: pr\
                                        |   ivate
                                        | -&gt; date: Mon, 21 Oct 2013 \
                                        |   20:13:22 GMT
c0                                      | == Indexed - Add ==
                                        |   idx = 64
                                        | -&gt; location: https://www.e\
                                        |   xample.com
5a                                      | == Literal indexed ==
                                        |   Indexed name (idx = 26)
                                        |     content-encoding
83                                      |   Literal value (len = 3)
                                        |     Huffman encoded:
9bd9 ab                                 | ...
                                        |     Decoded:
                                        | gzip
                                        | - evict: date: Mon, 21 Oct\
                                        |    2013 20:13:21 GMT
                                        | -&gt; content-encoding: gzip
77                                      | == Literal indexed ==
                                        |   Indexed name (idx = 55)
                                        |     set-cookie
ad                                      |   Literal value (len = 45)
                                        |     Huffman encoded:
94e7 821d d7f2 e6c7 b335 dfdf cd5b 3960 | .........5...[9`
d5af 2708 7f36 72c1 ab27 0fb5 291f 9587 | ..'..6r..'..)...
3160 65c0 03ed 4ee5 b106 3d50 07        | 1`e...N...=P.
                                        |     Decoded:
                                        | foo=ASDJKHQKBZXOQWEOPIUAXQ\
                                        | WEOIU; max-age=3600; versi\
                                        | on=1
                                        | - evict: location: https:/\
                                        |   /www.example.com
                                        | - evict: :status: 307
                                        | -&gt; set-cookie: foo=ASDJKHQ\
                                        |   KBZXOQWEOPIUAXQWEOIU; ma\
                                        |   x-age=3600; version=1</pre></span></div><div id="rfc.section.C.6.3.p.5"><span id="rfc.figure.u.82"><p>動的テーブル (デコード後):</p><pre>
[  1] (s =  98) set-cookie: foo=ASDJKHQKBZXOQWEOPIUAXQWEOIU; max-age\
                 =3600; version=1
[  2] (s =  52) content-encoding: gzip
[  3] (s =  65) date: Mon, 21 Oct 2013 20:13:22 GMT
      Table size: 215</pre></span></div><div id="rfc.section.C.6.3.p.6"><span id="rfc.figure.u.83"><p>デコードされたヘッダリスト:</p><pre>
:status: 200
cache-control: private
date: Mon, 21 Oct 2013 20:13:22 GMT
location: https://www.example.com
content-encoding: gzip
set-cookie: foo=ASDJKHQKBZXOQWEOPIUAXQWEOIU; max-age=3600; version=1</pre></span></div></div></div></div><div class="avoidbreak"><h1 id="rfc.authors"><a href="#rfc.authors">Authors' Addresses</a></h1><p><b>Roberto Peon</b><br>Google, Inc<br>Email: fenix@google.com</p><p><b>Hervé Ruellan</b><br>Canon CRF<br>Email: herve.ruellan@crf.canon.fr</p></div></body></html>
